<html>
<head>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"
            integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css"
          href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css">
    <link rel="stylesheet" type="text/css"
          href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css">

    <link href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" rel="stylesheet" type="text/css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800&amp;display=swap"
          rel="stylesheet">
</head>

<body style="padding-top: 0px; background-color:#ffffff;margin:0;">
<div id="braindw_Gondola" class="braindw-internal-container">
    <style>section {
        background: none;
    }

    #braindw_container {
        margin: 0;
        padding: 0;
        line-height: 1.5;
    }

    #braindw_container .braindw_owl-carousel {
        width: 60%;
    }

    #braindw_container section {
        display: block;
    }

    #braindw_container .braindw_row {
        flex-wrap: wrap;
        margin: 0 auto;
    }

    #braindw_container .braindw_owl-carousel .braindw_item {
        font-family: "Poppins", sans-serif !important;
        margin: 5px;
        padding: 10px;
        background: #fff;
        border: 1px solid #ddd;
        height: 100%;
        display: flex;
        flex-direction: column;
    }

    #braindw_container .braindw_owl-carousel .braindw_item:hover {
        z-index: 4;
        transition: all .4s;
        cursor: pointer;
        -webkit-box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
        -moz-box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
        -ms-box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
    }

    .braindw_owl-carousel {
        width: 100%;
        z-index: 1
    }

    .braindw_owl-carousel, .braindw_owl-carousel .owl-item {
        -webkit-tap-highlight-color: transparent;
        position: relative
    }

    .braindw_owl-carousel .owl-stage {
        position: relative;
        -ms-touch-action: pan-Y;
        touch-action: manipulation;
        -moz-backface-visibility: hidden
    }

    .braindw_owl-carousel .owl-stage:after {
        content: ".";
        display: block;
        clear: both;
        visibility: hidden;
        line-height: 0;
        height: 0
    }

    .braindw_owl-carousel .owl-stage-outer {
        position: relative;
        overflow: hidden;
        -webkit-transform: translate3d(0, 0, 0);
        height: fit-content;
    }

    .braindw_owl-carousel .owl-item {
        min-height: 1px;
        float: left;
        -webkit-backface-visibility: hidden;
        -webkit-touch-callout: none
    }

    .braindw_owl-carousel.owl-loading {
        opacity: 0;
        display: block
    }

    .braindw_owl-carousel.owl-refresh .owl-item {
        visibility: hidden
    }

    .braindw_owl-carousel.owl-drag .owl-item {
        -ms-touch-action: pan-y;
        touch-action: pan-y;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none
    }

    #braindw_container .braindw_columns {
        display: flex;
    }

    #braindw_container .main-title {
        font-family: "Poppins", sans-serif;
        color: #5b5b5f;
        font-weight: 400;
        line-height: 1;
        letter-spacing: -.19px;
        margin-right: 12px;
        max-width: 500px;
        font-size: 32px;
        margin: 20px 10px;
    }

    #braindw_container .braindw_owl-carousel .braindw_item .braindw_main_container_mob_a {
        width: 100%;
        margin: 5px auto 10px;
        position: relative;
    }

    #braindw_container .braindw_owl-carousel .braindw_item .braindw_main_container_mob_b {
        margin-top: 0px;
        width: 100%;
    }

    #braindw_container .braindw_prod {
        display: flex;
        align-items: center;
        justify-content: center;
    }

    #braindw_container .braindw_prod img {
        width: 90%;
        height: auto;
        opacity: 1;
    }

    #braindw_container .product-item-badge {
        pointer-events: none;
        z-index: 1;
        position: absolute;
        top: 24px;
        left: 0;
        height: 100%;
        margin: 0;
        padding: 0;
    }

    #braindw_container .product-item-badge > ul {
        margin: 0;
        padding: 0;
        list-style: none none;
        padding-bottom: 100%;
        position: relative;
    }

    #braindw_container .product-item-badge > ul li {
        list-style: none none;
        top: 0px;
        left: 0px;
        z-index: 10;
        position: absolute;
        white-space: nowrap;
        margin: 0;
    }

    #braindw_container .product-item-badge ul > li img {
        max-height: 28px;
        display: block;
        vertical-align: middle;
    }

    #braindw_container .product-item-badgecombo {
        pointer-events: none;
        z-index: 1;
        position: absolute;
        bottom: 0;
        left: 0;
        margin: 25px 0 25px 0;
        padding: 0;
    }

    #braindw_container .product-item-badgecombo > ul {
        margin: 0;
        padding: 0;
        list-style: none none;
        padding-bottom: 100%;
        position: relative;
    }

    #braindw_container .product-item-badgecombo > ul li {
        list-style: none none;
        top: 0px;
        left: 0px;
        z-index: 10;
        position: absolute;
        white-space: nowrap;
        margin: 0;
    }

    #braindw_container .product-item-badgecombo ul > li img {
        max-height: 28px;
        display: block;
        vertical-align: middle;
    }

    #braindw_container .product-item-badgecombo ul > li img.flag_cyber {
        margin: 35px 0 0 0;
    }

    #braindw_container .product-item-badge {
        pointer-events: none;
        z-index: 1;
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        margin: 0;
        padding: 0;
    }

    #braindw_container .container-info {
        margin: 5px 0 10px;
        height: 61px;
    }

    #braindw_container .product-name {
        font-size: 13px;
        line-height: 17px;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
        text-overflow: ellipsis;
        font-weight: 300;
        max-height: 50px;
        height: 50px;
        text-decoration: none;
        color: #5b5b5f;
    }

    #braindw_container .prices_content {
        margin: 0;
        height: 80px;
    }

    #braindw_container .prices_content .list_prices {
        color: #999999;
        margin: 0;
        font-weight: 400;
        font-size: 14px;
        text-decoration: line-through;
    }

    #braindw_container .prices_content .pr_percentage {
        display: flex;
        flex-wrap: wrap;
        align-items: center
    }

    #braindw_container .prices_content .best_price_reg {
        color: #d27f45;
        text-decoration: none;
        font-size: 22px;
        margin: 0;
        font-weight: 400;
        margin-right: 10px;
    }

    #braindw_container .prices_content .special-discount {
        font-size: 14px;
        line-height: 16px;
        color: #333;
        padding: 4px 11px;
        display: inline-block;
        vertical-align: middle;
        background-color: #e0ffc0;
        border-radius: 20px;
        white-space: nowrap;
    }

    #braindw_container .btn {
        display: flex;
        -webkit-align-items: center;
        -ms-align-items: center;
        align-items: center;
        -webkit-flex-wrap: wrap;
        flex-wrap: wrap;
        margin: 10px 0 5px;
    }

    #braindw_container .btn input {
        background-color: #f9f9fc;
        width: 40px;
        height: 35px;
        font-size: 13px;
        margin-right: 10px;
        color: #5b5b5f;
        text-align: center;
        padding: 0;
        border: 1px solid #ddd;
        font-family: "Poppins";
        outline: none;
    }

    #braindw_container .buyButton {
        background: #d27f45;
        color: #fff;
        cursor: pointer;
        font-weight: 400;
        font-size: 14px;
        line-height: 14px;
        border-radius: 30px;
        text-decoration: none;
        flex-grow: 1;
        padding: 8px 10px 10px;
        width: auto;
        text-align: center;
    }

    #braindw_container .buyButton.disabled {
        opacity: .5;
        cursor: default;
        pointer-events: none;
    }

    .braindw_owl-carousel .owl-next::after {
        content: "";
        height: 75px;
        width: 75px;
        background-image: url(https://storage.cdn.braindw.com/clubdebeneficios_produccion/script/files/2021/06/25/cb_next_1.png);
        display: block;
    }

    .braindw_owl-carousel .owl-prev::after {
        content: "";
        height: 75px;
        width: 75px;
        background-image: url(https://storage.cdn.braindw.com/clubdebeneficios_produccion/script/files/2021/06/25/cb_prev_1.png);
        display: block;
    }

    .braindw_owl-carousel .owl-next {
        right: 10px;
    }

    .braindw_owl-carousel .owl-prev {
        right: 90px;
    }

    .braindw_owl-theme .owl-nav {
        text-align: center;
        -webkit-tap-highlight-color: transparent;
        margin-top: 10px;
    }

    .braindw_owl-theme .owl-nav [class*=owl-] {
        cursor: pointer;
        position: absolute;
        top: -18%;
        width: 75px;
        height: 75px;
        font-size: 0;
        z-index: 1;
        outline: none;
        border: none;
        background: transparent;
    }

    .bw_imagen_lateral_simple img {
        margin: 5px 5px 0 5px;
        height: 405px;
    }

    .braindw_blockEv {
        position: absolute;
        background-color: #F6F6F6;
        z-index: 999;
        height: 100%;
        width: 100%;
        opacity: 0.5;
    }

    .bt_vermas_mobile {
        display: none;
    }

    #braindw_container .owl-dots {
        display: block;
        padding: 20px 0;
        position: relative;
        text-align: center;
        width: 100%;
        left: 0;
        bottom: 0;
        z-index: 10;
    }

    button.owl-dot.active {
        background: #D27F45
    }

    button.owl-dot {
        background: #DDDDDD;
        border: 0;
        display: inline-block;
        vertical-align: top;
        margin: 0px 8px;
        border-radius: 100%;
        height: 10px;
        width: 10px;
        -webkit-transition: 0.3s all;
        transition: 0.3s all;
        padding: 0px;
        cursor: pointer;
    }

    @media only screen and (max-width: 660px) {
        .bw_imagen_lateral_simple {
            display: none;
        }

        #braindw_container .braindw_owl-carousel {
            width: 100%;
        }
    }

    @media only screen and (max-width: 480px) {
        .braindw_owl-theme .owl-nav {
            display: none;
        }

        #braindw_container .owl-dots {
            display: none;
        }

        #braindw_container .braindw_row {
            width: 100%;
            padding: 0;
        }

        .owl-dot {
            text-align: center;
        }

        #braindw_container .prices_content .special-discount {
            font-size: 12px;
            padding: 1px 11px;
        }

        #braindw_container .main-title {
            font-size: 20px;
        }

        #braindw_container .product-item-badge {
            top: 16px
        }
    }

    /*Cambio suma*/
    #braindw_container .item-qty.input-qty-item {
        font-size: 13px;
        color: #5b5b5f;
        text-align: center;
        padding: 0;
    }

    #braindw_container .item-qty.input-qty-item {
        text-align: center;
        padding: 0;
        background-color: #f9f9fc;
        border-color: #dddddd;
        width: 100px;
        height: 35px;
        border-left: none;
        border-right: none;
        border-top: 1px solid #d27f45;
        border-bottom: 1px solid #d27f45;
    }

    #braindw_container .added .details-qty {
        display: inline-flex;
    }

    #braindw_container .qty-control.qty-deduce {
        display: inline-block;
        text-decoration: none;
    }

    #braindw_container .qty-control.qty-deduce {
        border-radius: 45% 1% 1% 45%;
    }

    #braindw_container .qty-control.qty-add {
        display: inline-block;
        text-decoration: none;
    }
    #braindw_container .qty-control.qty-add {
        border-radius: 1% 45% 45% 1%;
    }

    #braindw_container .qty-control {
        display: block;
        width: 40px;
        height: 35px;
        color: #FFF;
        font-size: 20px;
        line-height: 35px;
        background: #D27F45;
        -webkit-touch-callout: none;
        user-select: none;
        text-decoration: none;
        text-align: center;
        cursor: pointer;
    }

    #braindw_container .action.tocart {
        -webkit-flex-grow: 1;
        flex-grow: 1;
        /*padding: 8px 10px 10px;*/
        width: 180px;
        border-radius: 25px;
        background-image: none;
        background: #d27f45;
        border: 1px solid #d27f45;
        color: #ffffff;
        cursor: pointer;
        display: inline-block;
        font-family: 'Poppins', 'Helvetica Neue', Helvetica, Arial, sans-serif;
        font-weight: 400;
        margin: 0;
        /*font-size: 1.6rem;*/
        line-height: 1.4rem;
        box-sizing: border-box;
        vertical-align: middle;
        text-transform: none;
        padding: 5px 0 5px;
        font-size: 17px;
    }

    #braindw_container .enable_delete_button .qty-deduce:before {
        content: "\f176";
    }

    #braindw_container .addtocart-qty-container.enable_delete_button .qty-deduce > span {
        border: 0;
        clip: rect(0, 0, 0, 0);
        height: 1px;
        margin: -1px;
        overflow: hidden;
        padding: 0;
        position: absolute;
        width: 1px;
    }
    /* end Cambio suma*/

    </style>

</div>

<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>

<script>
/*summa*/
var currentCartData = {};
window.addEventListener('message', function (event) {
    /*if (event.origin !== domain) return;*/
    console.log('Received response: ', event.data);
    console.log('Received origin: ', event.origin);
    currentCartData = event.data;
    for (var key in currentCartData.items) {
        console.log("itemmm->",currentCartData.items[key]);
        var productId = currentCartData.items[key].product_id;
        var productSku = currentCartData.items[key].product_sku;
        var qtyProductInCart = currentCartData.items[key].qty;
        $("#qty_" + productSku).val(qtyProductInCart);
    }
}, false);

$(document).on('submit','form',function(e){
    e.preventDefault();
    console.log("enviando antes de submit...");
    window.parent.postMessage({"product": $(this).attr("id"), "item" }, '*');
    //var form = $(this);
    //var formData = new FormData(form[0]);

    /*$.ajax({
        url: form.attr('action'),
        headers: {'Access-Control-Allow-Origin': 'https://unilever-club-de-beneficios2.localhost'},
        crossDomain: true,
        data: formData,
        type: "POST",
        dataType: "json",
        cache: false,
        contentType: false,
        processData: false,

        beforeSend: function () {
            console.log("enviando request...");
        },

        success: function (res) {
            console.log("success request...");
        },

        error: function (xhr, textStatus, errorThrown) {
            console.log("error request...",textStatus);
        },

        complete: function (res) {
            console.log("complete request...");
        }
    });*/


    return  false;
});
/*end summa*/

function ClickEventUrl(data) {
    console.log(data);
    window.parent.postMessage("BraindwClickRedirectParent|" + data , '*');
   }

function braindwGetUrlParameter(name) {
    name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
    var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
    var results = regex.exec(location.search);
    return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
}

function BraindwAddToCart(data,element) {
    var urlToCart=data.split("|")[1];
    var urlLink=data.split("|")[0].split("_")[0];
    var sku= data.split("|")[0].split("_")[6];
    console.log("skudatafromiframe->"+sku);
    console.log("skudatafromiframe->"+urlToCart);
    console.log("skudatafromiframe->"+urlLink);
    var bdwAttrCat = 'banner';
    var bdwAttrEti = 'default';
    try {
        bdwAttrCat = jQuery(element).attr('bw-section');
    } catch (err) {}
    try {
        bdwAttrEti = jQuery(element).attr('bw-title');
    } catch (err) {}

    $(element).addClass('disabled');
    $(element).text('Añadir');
    setTimeout(function(){
      $(element).removeClass('disabled');
      $(element).text('Añadido');
      $(element).text('Agregar');
    },2000)
    var quantity = $(element).closest('form').find('input').val();
    var datasend=data.split("|")[0]+"_"+ quantity;
    console.log("datasend->",datasend);
    window.parent.postMessage("BraindwEventAnalyticsBuy|"+ datasend , '*');
    window.parent.postMessage("BraindwAddCartEvent|"+urlToCart+"," + sku +"," + quantity + "," + urlLink +"," + bdwAttrEti+"," + bdwAttrCat, '*');

}

var bdwMobile = {
    Android: function() {
        return navigator.userAgent.match(/Android/i);
    },
    BlackBerry: function() {
        return navigator.userAgent.match(/BlackBerry/i);
    },
    iOS: function() {
        return navigator.userAgent.match(/iPhone|iPad|iPod/i);
    },
    Opera: function() {
        return navigator.userAgent.match(/Opera Mini/i);
    },
    Windows: function() {
        return navigator.userAgent.match(/IEMobile/i);
    },
    any: function() {
        return (bdwMobile.Android() || bdwMobile.BlackBerry() || bdwMobile.iOS() || bdwMobile.Opera() || bdwMobile.Windows());
    }
};

function BraindwBuildImage(config, orientation, mobile) {
    var imageHtml = '';
    if (config !== null && config !== undefined && config.floatImage.indexOf(orientation) > -1) {
        var image = '',link, classImage='';
        if (config.imagesObjects.length > 1 ) {
            image = orientation === 'left' ? config.imagesObjects[0].url : config.imagesObjects[1].url;
            link = orientation === 'left' ? config.imagesObjects[0].linkImg : config.imagesObjects[1].linkImg;
            classImage='simple-doble'
        }else{
            image =config.imagesObjects[0].url;
            link = config.imagesObjects[0].linkImg;
            classImage = 'simple-doble-'+config.minus;
        }

        imageHtml = '<div class="bw_imagen_lateral_simple" data-minus="'+config.minus+'">'+
            '<a href="'+link+'" target="_parent" bw-title="banner" bw-section="%sectionEvent%" bw-sku="" onclick="ClickEventUrl('+"'"+link+"'"+',this);return false;"><img class='+classImage+' src="'+image+'" style=""></a>'+
            '</div>';
    }

    if (mobile && config !== null && config !== undefined) {
        var link = config.imagesObjects[0].linkImg === '' && config.additionalComponent.value !== '' ?
        config.additionalComponent.value :
        config.imagesObjects[0].linkImg;

        imageHtml = '<div class="bt_vermas_mobile"><a href="'+link+'" target="_parent" onclick="ClickEventUrl('+"'"+link+"'"+',this);return false;">Ver Todo</a></div>';
    }

    return imageHtml;
}

function BdwGondolaStyle(gondola_selector, slider_width, slider_padding, slider_float_side, margin, type) {
    var headerStyle = '';
    let cuca_top = '16px';
    if (type === "header") {
        cuca_top = bdwMobile.any() !== null ? '-16px':'16px';
         headerStyle =
         '#braindw_container div.braindw_row { width:92%;  }'+
         '#braindw_container section{display:inline-block;}' +
         '#braindw_container .braindw_owl-carousel .braindw_item{flex-direction: row !important;}' +
         '#braindw_container .braindw_main_container_mob_a{width:50%;margin:0 !important;}' +
         '#braindw_container .braindw_main_container_mob_b{width:50%;margin:0 !important;padding:10px 15px;}' +

         '#braindw_container .braindw_prod{padding: 10px 0 0 0 !important;}' +
         '#braindw_container .container-info{height:50px;}'+

         '.braindw_owl-theme .owl-nav [class*=owl-]{top:30% !important;}'+
         '.braindw_owl-theme .owl-nav{display:initial !important;}'+
         '.braindw_owl-carousel .owl-next {right: -35px !important;}'+
         '.braindw_owl-carousel .owl-prev{left: -35px !important;}'+
         '#braindw_container .owl-dots {bottom: 0;text-align: center; display:block !important}' +
         '#braindw_container .owl-dots .owl-dot {width: 0.8em;height: 0.8em;background: #ccc;display: inline-block;vertical-align: middle;margin: 0 5px; -webkit-border-radius: 100%; border-radius: 100%; padding:0; border: none;outline:none;cursor: pointer;}' +
         '#braindw_container .owl-dots .owl-dot.active {background: #d27f45;border: none;outline:none;}' +
         '#braindw_container .main-title {display:none;}' +
         '#braindw_container .product-item-badge{left: 110px;}'+

            '@media only screen and (max-width :480px){'+
            '#braindw_container .braindw_owl-carousel .braindw_item{padding: 0 !important;}'+
            '#braindw_container .braindw_owl-carousel .braindw_item .braindw_main_container_mob_b{display: flex;flex-direction: column;justify-content: center;}' +
            '#braindw_container .prices_content{padding: 10px 0 !important;height: auto !important;}'+
            '.braindw_owl-theme .owl-nav [class*=owl-]{display: none !important;}' +
            '#braindw_container .product-name{max-height: 35px !important;height: 35px !important;}'+
            '#braindw_container .btn{margin:0 0 10px !important;}'+
            '#braindw_container .braindw_prod img{width:100% !important;}' +
            '#braindw_container .product-item-badge{top: -16px;left: 5px !important;}'+
            '#braindw_container .product-item-badgecombo{bottom:0;left:0;}'+
            '#braindw_container .braindw_main_container_mob_a{width:40% !important;}' +
            '#braindw_container .braindw_main_container_mob_b{width:60% !important;}' +

            '}';
    }

    return '<style>' + headerStyle +
     /*Sección Item*/
     'section {background: none;}'+
     '#braindw_container{margin:0;padding:0;line-height:1.5;} '+
     '#braindw_container .braindw_owl-carousel{ width:'+slider_width+';'+margin+' }' +
     '#braindw_container section{display:block;}' +
     '#braindw_container .braindw_row{flex-wrap: wrap; margin: 0 auto;}' +
     '#braindw_container .braindw_owl-carousel .braindw_item{font-family: "Poppins", sans-serif !important;margin: 5px;padding: 10px;background: #fff;border: 1px solid #ddd;height: 100%;display: flex;flex-direction: column;}' +
     '#braindw_container .braindw_owl-carousel .braindw_item:hover{z-index: 4; transition: all .4s;cursor:pointer;-webkit-box-shadow: 0 0 5px rgba(0,0,0,0.2);-moz-box-shadow: 0 0 5px rgba(0,0,0,0.2);-ms-box-shadow: 0 0 5px rgba(0,0,0,0.2);box-shadow: 0 0 5px rgba(0,0,0,0.2);}' +
     '.braindw_owl-carousel{width:100%;z-index:1}' +
     '.braindw_owl-carousel,.braindw_owl-carousel .owl-item{-webkit-tap-highlight-color:transparent;position:relative}' +
     '.braindw_owl-carousel .owl-stage{position:relative;-ms-touch-action:pan-Y;touch-action:manipulation;-moz-backface-visibility:hidden}' +
     '.braindw_owl-carousel .owl-stage:after{content:".";display:block;clear:both;visibility:hidden;line-height:0;height:0}' +
     '.braindw_owl-carousel .owl-stage-outer{position:relative;overflow:hidden;-webkit-transform:translate3d(0,0,0);height: fit-content;}' +
     '.braindw_owl-carousel .owl-item{min-height:1px;float:left;-webkit-backface-visibility:hidden;-webkit-touch-callout:none}' +
     '.braindw_owl-carousel.owl-loading{opacity:0;display:block}' +
     '.braindw_owl-carousel.owl-refresh .owl-item{visibility:hidden}' +
     '.braindw_owl-carousel.owl-drag .owl-item{-ms-touch-action:pan-y;touch-action:pan-y;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}' +
     '#braindw_container .braindw_columns { display: flex;}'+

 /*Sección Contenedores*/
     '#braindw_container .main-title {font-family: "Poppins", sans-serif;color: #5b5b5f;font-weight: 400;line-height: 1;letter-spacing: -.19px;margin-right: 12px;max-width: 500px;font-size: 32px;margin: 20px 10px;}' +
     '#braindw_container .braindw_owl-carousel .braindw_item .braindw_main_container_mob_a{width: 100%; margin: 5px auto 10px; position: relative;}' +
     '#braindw_container .braindw_owl-carousel .braindw_item .braindw_main_container_mob_b{margin-top:0px;width:100%;}' +

 /*Sección a- imagen-cucardas*/
     '#braindw_container .braindw_prod{display: flex;align-items: center;justify-content: center;}' +
     '#braindw_container .braindw_prod img{width:90%;height: auto;opacity: 1;}' +

     '#braindw_container .product-item-badge{pointer-events: none;z-index: 1;position: absolute;top: 24px;left: 0; height: 100%;margin: 0;padding: 0;}'+
     '#braindw_container .product-item-badge>ul {margin: 0;padding: 0;list-style: none none;padding-bottom: 100%;position: relative;}'+
     '#braindw_container .product-item-badge>ul li{list-style: none none;top: 0px;left: 0px;z-index: 10;position: absolute;white-space: nowrap;margin: 0;}'+
     '#braindw_container .product-item-badge ul>li img{max-height: 28px;display: block;vertical-align: middle;}'+
     '#braindw_container .product-item-badgecombo{pointer-events: none;z-index: 1;position: absolute;bottom: 0;left: 0;margin: 25px 0 25px 0;padding: 0;}'+
     '#braindw_container .product-item-badgecombo>ul {margin: 0;padding: 0;list-style: none none;padding-bottom: 100%;position: relative;}'+
     '#braindw_container .product-item-badgecombo>ul li{list-style: none none;top: 0px;left: 0px;z-index: 10;position: absolute;white-space: nowrap;margin: 0;}'+
     '#braindw_container .product-item-badgecombo ul>li img{max-height: 28px;display: block;vertical-align: middle;}'+

     '#braindw_container .product-item-badgecombo ul>li img.flag_cyber {margin: 35px 0 0 0;}'+
     '#braindw_container .product-item-badge{pointer-events: none;z-index: 1;position: absolute;top: 0;left: 0; height: 100%;margin: 0;padding: 0;}'+
 /*Sección Info*/
     '#braindw_container .container-info{margin: 5px 0 10px;height:61px;}'+
     '#braindw_container .product-name{font-size: 13px;line-height: 17px;-webkit-line-clamp: 3;-webkit-box-orient: vertical;overflow: hidden;text-overflow: ellipsis;font-weight: 300;max-height: 50px;height: 50px;text-decoration: none;color: #5b5b5f;}' +
     '#braindw_container .prices_content{margin: 0; height: 80px;}' +
     '#braindw_container .prices_content .list_prices{color: #999999;margin: 0;font-weight: 400;font-size: 14px;text-decoration: line-through;}' +
     '#braindw_container .prices_content .pr_percentage{display: flex;flex-wrap: wrap;align-items: center}'+
     '#braindw_container .prices_content .best_price_reg{color: #d27f45;text-decoration: none;font-size: 22px;margin: 0; font-weight: 400;margin-right: 10px;}' +
     '#braindw_container .prices_content .special-discount{font-size: 14px;line-height: 16px;color: #333;padding: 4px 11px;display: inline-block;vertical-align: middle;background-color: #e0ffc0;border-radius: 20px;white-space: nowrap;}'+

     '#braindw_container .btn{display: flex;-webkit-align-items: center;-ms-align-items: center;align-items: center;-webkit-flex-wrap: wrap;flex-wrap: wrap;margin: 10px 0 5px;}'+
     '#braindw_container .btn input{background-color: #f9f9fc;width: 40px;height: 35px;font-size: 13px;margin-right: 10px;color: #5b5b5f;text-align: center;padding: 0;border: 1px solid #ddd;font-family:"Poppins";outline: none;}'+
     '#braindw_container .buyButton {background: #d27f45;color: #fff;cursor: pointer;font-weight: 400;font-size: 14px;line-height: 14px;border-radius: 30px;text-decoration:none;flex-grow: 1;padding: 8px 10px 10px;width: auto;text-align: center;}'+
     '#braindw_container .buyButton.disabled { opacity: .5; cursor: default; pointer-events: none; }'+

 /*Sección Bullets-nav*/
     '.braindw_owl-carousel .owl-next::after{content: "";height: 75px;width: 75px;background-image: url(https://storage.cdn.braindw.com/clubdebeneficios_produccion/script/files/2021/06/25/cb_next_1.png);display: block;}'+
     '.braindw_owl-carousel .owl-prev::after{content: "";height: 75px;width: 75px;background-image: url(https://storage.cdn.braindw.com/clubdebeneficios_produccion/script/files/2021/06/25/cb_prev_1.png);display: block;}'+
     '.braindw_owl-carousel .owl-next{right: 10px;}'+
     '.braindw_owl-carousel .owl-prev{right: 90px;}'+
     '.braindw_owl-theme .owl-nav{text-align:center;-webkit-tap-highlight-color:transparent;margin-top:10px;}'+
     '.braindw_owl-theme .owl-nav [class*=owl-]{cursor: pointer;position: absolute;top: -18%;width: 75px;height: 75px;font-size: 0;z-index: 1;outline: none;border: none;background: transparent;}' +

     '.bw_imagen_lateral_simple img{ margin: 5px 5px 0 5px; height:405px;}'+
     '.braindw_blockEv { position: absolute;background-color: #F6F6F6;z-index: 999;height: 100%;width: 100%;opacity: 0.5; }'+
     '.bt_vermas_mobile { display: none;}'+
     '#braindw_container .owl-dots { display: block;padding: 20px 0;position: relative;text-align: center;width: 100%;left: 0;bottom: 0;z-index: 10; }'+
     'button.owl-dot.active { background: #D27F45 }'+
     'button.owl-dot{background: #DDDDDD;border: 0;display: inline-block;vertical-align: top;margin: 0px 8px;border-radius: 100%;height: 10px;width: 10px;-webkit-transition: 0.3s all;transition: 0.3s all;padding: 0px; cursor: pointer;}'+

     '@media only screen and (max-width :660px){'+
        '.bw_imagen_lateral_simple { display: none; } '+
        '#braindw_container .braindw_owl-carousel { width:100%; }'+
     '}'+
 /*Sección @media*/
     '@media only screen and (max-width :480px){'+
         '.braindw_owl-theme .owl-nav{display: none;}'+
         '#braindw_container .owl-dots {display: none;}'+
         '#braindw_container .braindw_row{width: 100%; padding: 0;}' +
         '.owl-dot{text-align:center;}' +
         '#braindw_container .prices_content .special-discount{font-size: 12px;padding: 1px 11px;}'+
         '#braindw_container .main-title { font-size: 20px; }'+
         '#braindw_container .product-item-badge{top: '+cuca_top+'}'+
     '}' +
    '</style>';
}

function BraindwRenderBanner(data, gondola, title, eventName, sufix, configs, linkBoton, type) {
    if (data !== null && data.length > 0) {

        var hash = {};
        data = data.filter(function(current) {
          var exists = !hash[current.IdArticulo];
          hash[current.IdArticulo] = true;
          return exists;
        });

        var url = braindwGetUrlParameter('url_parent');
        data = data.filter(function (n) { return decodeURI(url).indexOf(n.Link) ===-1 && n.Precio !== "0"; });
        var bdwIsLogged = braindwGetUrlParameter('isLogged');

        if (data.length === 0) { return ''; }
        if (type === "header" && data.length === 1) { return '';}

        var minus = configs !== null ? configs.minus : 0;
        var buttonLink = '';

        if (linkBoton !== null && linkBoton !== undefined && linkBoton !== '' &&linkBoton !== '<%TEMPLATE_LINK_BOTON%>') {
            buttonLink = '<a href="'+linkBoton+'" target="_parent" onclick="ClickEventUrl('+"'"+linkBoton+"'"+',this);return false;">Ver todo</a>';
        }
        var key = "bdw-clicked-products";
        var titleAlert = type === "header" ? '' : '';
        var divHeader = type === "header" && bdwMobile.any() !== null ? '<div style="display:flex;height:195px;align-items: center;"> ' : '';
        var divEndHeader = type === "header" && bdwMobile.any() !== null ? '</div> ' : '';
        var displayTitle =  title !== '' ? 'visible' : 'hidden';
        var shelfname=title;
        var templateBigBannerCategoria =
            '<section id="braindw_container">' +
                '<div class="braindw_blockEv" style="display:none"></div>'+
                '<div class="braindw_row">' +
                '<div class="main-title" style="visibility:'+displayTitle+'"><span>' + title + '</span></div>' +
                '<div class="braindw_columns">' +
                    //imagen lateral
                    BraindwBuildImage(configs, 'left')+
                //imagen lateral
                    '<div class="braindw_owl-carousel braindw_owl-theme ' + gondola + ' bdwtemplate-'+minus+'">';

        var itemtemplateBigBannerCategoria =
            '<div class="braindw_item" data-id="%idArticulo%" style="opacity:%opacityStock%">' +
                divHeader+

                '<section class="braindw_main_container_mob_a">' +
                    '<div class="product-item-badge" style="visibility:%visibility_cucanocombo%">'+
                        '<ul>'+
                            '<li>'+
                                '<img src="%CucardaUrlImage%" class="%cucacyber%">'+
                            '</li>'+
                        '</ul>'+
                    '</div>' +
                    '<div class="product-item-badgecombo" style="visibility:%visibility_cucacombo%">'+
                        '<ul>'+
                            '<li>'+
                                '<img src="%CucardaUrlImageExterna%" >'+
                            '</li>'+
                        '</ul>'+
                    '</div>' +

                    '<a href="%link%" onclick="ClickEventUrl(\'%data%\',this);return false;" class="braindw_prod _braindwTriggerClick" bw-title="%Descripcion%" bw-section="%sectionEvent%" bw-sku="%idArticulo%">' +
                        '<img src="%urlImage%">'+
                    '</a>' +
                '</section>' +

                '<section class="braindw_main_container_mob_b">' +
                    '<div class="prices_content" style="display:%visibility_price%">' +
                        '<div class="list_prices" style="visibility:%precioAnterio_visibility%;">%PrAnt%</div>'+
                        '<div class="pr_percentage">'+
                            '<div class="best_price_reg">%Precio%</div>' +
                            '<span class="special-discount" style="visibility:%display_cuca%">%CucardaOferta%</span>'+
                        '</div>'+
                    '</div>' +

                    '<div class="container-info">'+
                        '<a href="%link%" onclick="ClickEventUrl(\'%data%\',this);return false;" class="product-name" bw-title="%Descripcion%" bw-section="%sectionEvent%" bw-sku="%idArticulo%">%Descripcion%</a>' +
                    '</div>'+
                    '<form class="btn" style="display:%display_view%">'+
                        '<a href="%link%" onclick="ClickEventUrl(\'%data%\',this);return false;" class="buyButton" data-id="" bw-title="%Descripcion%" bw-section="%sectionEvent%" bw-sku="%idArticulo%">Ver Producto</a>'+
                    '</form>'+
                    '<!--Cambio summa-->'+
                    '<!--<form class="btn" style="display:%display_addCart%">'+
                        '<input type="text" min="1" value="1" tabindex="0">'+
                        '<a onclick="BraindwAddToCart(\'%cart_data%\',this);return false;" class="buyButton action tocart primary" data-id="" bw-title="%Descripcion%" bw-section="%sectionEvent%" bw-sku="%idArticulo%">Agregar</a>'+
                        '</form>-->'+
                    '<form>'+
                        '<div class="addtocart-qty-container added" align="center">'+
                            '<div class="details-qty qty quantity-control-initialized">'+
                                '<a class="qty-control qty-deduce" tabindex="0">'+
                                    '<span>-</span>'+
                                '</a>'+
                                '<input value="1" type="number" size="4" min="1" class="item-qty input-qty-item" id="qty_%idArticulo%" tabindex="0">'+
                                '<a class="qty-control qty-add"><span>+</span></a>'+
                            '</div>'+
                            '<a onclick="BraindwAddToCart(\'%cart_data%\',this);return false;" type="submit" title="Agregar" class="buyButton action tocart border" tabindex="0" data-id="" bw-title="%Descripcion%" bw-section="%sectionEvent%" bw-sku="%idArticulo%">'+
                                '<span class="desktop-hide">Agregar</span>'+
                            '</a>'+
                        '</div>'+
                    '</form>'+



                    '<!--<form data-role="tocart-form"'+
                          'id="brain_carrousel_2220"'+
                          'data-product-sku="Jabon-dos-test"'+
                          'action="https://unilever-club-de-beneficios2.localhost/checkout/cart/add/uenc/aHR0cHM6Ly91bmlsZXZlci1jbHViLWRlLWJlbmVmaWNpb3MyLmxvY2FsaG9zdC8%2C/product/2220/"'+
                          'action-add="https://unilever-club-de-beneficios2.localhost/checkout/cart/add/uenc/aHR0cHM6Ly91bmlsZXZlci1jbHViLWRlLWJlbmVmaWNpb3MyLmxvY2FsaG9zdC8%2C/product/2220/"'+
                          'method="post">'+
                        '<input type="hidden" name="product" value="2220" tabindex="0">'+
                        '<input type="hidden" name="uenc" value="aHR0cHM6Ly91bmlsZXZlci1jbHViLWRlLWJlbmVmaWNpb3MyLmxvY2FsaG9zdC9jaGVja291dC9jYXJ0L2FkZC91ZW5jL2FIUjBjSE02THk5MWJtbHNaWFpsY2kxamJIVmlMV1JsTFdKbGJtVm1hV05wYjNNeUxteHZZMkZzYUc5emRDOCUyQy9wcm9kdWN0LzIyMjAv" tabindex="0">'+
                        '<input type="hidden" name="item_id" class="item-id-2220" value="" tabindex="0">'+
                        '<input type="hidden" name="item_qty" class="item-qty-2220" value="1" tabindex="0">'+
                        '<input name="form_key" type="hidden" value="cjwF3U9uhk4rKz7e" tabindex="0">'+
                        '<div class="addtocart-qty-container" align="center">'+
                            '<div data-role="details-qty" class="details-qty qty quantity-control-initialized">'+
                                '<a href="#input-qty-Jabon-dos-test"'+
                                   'class="qty-control qty-deduce disabled"'+
                                   'data-role="qty-deduce"'+
                                   'tabindex="0">'+
                                    '<span>-</span>'+
                                '</a>'+
                                '<input data-cart-item-id="2220"'+
                                       'data-item-qty="1"'+
                                       'value="1"'+
                                       'type="number"'+
                                       'size="4"'+
                                       'min="1"'+
                                       'class="item-qty input-qty-item disabled"'+
                                       'id="input-qty-Jabon-dos-test"'+
                                       'tabindex="0"'+
                                       'disabled="disabled">'+
                                '<a href="#input-qty-Jabon-dos-test" class="qty-control qty-add disabled" data-role="qty-add" tabindex="0">'+
                                    '<span>+</span>'+
                                '</a>'+
                                '<button data-cart-item="Jabon-dos-test" title="Actualizar" class="update-cart-item" style="display: none" tabindex="0">'+
                                    '<span>Actualizar</span>'+
                                '</button>'+
                            '</div>'+
                            '<button type="submit" title="Agregar" class="action tocart border" tabindex="0">'+
                                '<span class="desktop-hide">Agregar</span>'+
                            '</button>'
                        '</div>'+
                    '</form>-->'+



                    '<!--end Cambio summa-->'+
                '</section>' +
                divEndHeader+
            '</div>';


        $.each(data, function(i, item) {

            if (bdwMobile.any() !== null && i >= 10) {
                return;
            }

            var customLink = item.Link;
            var citem = itemtemplateBigBannerCategoria
            citem = citem.replace("%brand%", item.Marca);
            citem = citem.replace(/%Descripcion%/g, item.Descripcion);
            citem = citem.replace(/%idArticulo%/g, item.IdArticulo);
            citem = citem.replace(/%TitleEvent%/g, item.Descripcion);

            citem = citem.replace(/%opacityStock%/g, '');
            citem = citem.replace(/%displayAgotado%/g, 'none');
            citem = citem.replace(/%displayAddCart%/g,  'block');
            citem = citem.replace(/%displayQuantity%/g, 'none');
            citem = citem.replace("%urlImage%", item.UrlImagen);
            citem = citem.replace(/%link%/g, customLink);
            citem = citem.replace(/%sectionEvent%/g, eventName);
            citem = citem.replace(/%sku%/g, item.Sku);
            citem = citem.replace(/%CucardaOferta%/g, item.CucardaOferta);
            if (!item.CucardaOferta) {
                citem = citem.replace(/%display_cuca%/g, 'hidden');
            }else{
                citem = citem.replace(/%display_cuca%/g, 'visible');
            }
            if (bdwIsLogged === 'true') {
                citem = citem.replace(/%visibility_price%/g, 'initial');
                var price = item.Precio.indexOf(',') > -1 ?
                    item.Precio.split(',')[0] :
                    item.Precio;
                citem = citem.replace(/%Precio%/g, price);

                if (item.PrecioAnterior != '') {
                    var priceAnterior = item.PrecioAnterior.indexOf(',') > -1 ?
                        item.PrecioAnterior.split(',')[0] :
                        item.PrecioAnterior;
                    citem = citem.replace(/%PrAnt%/g, priceAnterior);
                    citem = citem.replace(/%precioAnterio_visibility%/g, bdwMobile.any() ? "visible" : "visible");
                } else {
                    citem = citem.replace(/%precioAnterio_visibility%/g, "hidden");
                }

                citem = citem.replace(/%display_addCart%/g, 'flex');
                citem = citem.replace(/%display_view%/g, 'none');
            }else{
                citem = citem.replace(/%display_view%/g, 'flex');
                citem = citem.replace(/%display_addCart%/g, 'none');
            }

            citem = citem.replace(/%visibility_price%/g, 'none');
            citem = citem.replace(/%linkToCart%/g, item.addToCart);

            var data=customLink+'_'+key+'_'+item.IdArticulo+'_'+eventName+'_'+item.Descripcion+'_'+shelfname+'_'+item.Sku+'_'+item.Marca+'_'+i+'_'+price;
            citem = citem.replace(/%data%/g, data);

            var cart_data=customLink+'_'+key+'_'+item.IdArticulo+'_'+eventName+'_'+item.Descripcion+'_'+shelfname+'_'+item.Sku+'_'+item.Marca+'_'+i+'_'+price+'|'+item.addToCart;
            citem = citem.replace(/%cart_data%/g, cart_data);

            if(item.Image_CucardaUrlImageExterna){
                citem = citem.replace(/%CucardaUrlImageExterna%/g, item.Image_CucardaUrlImageExterna);
                citem = citem.replace(/%visibility_cucacombo%/g, 'visible');

                if(item.Image_CucardaUrlImage){
                    citem = citem.replace(/%CucardaUrlImage%/g, item.Image_CucardaUrlImage);
                    citem = citem.replace(/%visibility_cucanocombo%/g, 'visible');
                    if (item.Image_CucardaUrlImage.indexOf('Artboard_7') > -1) {
                        citem = citem.replace(/%cucacyber%/g, 'flag_cyber');
                    }
                    citem = citem.replace(/%cucacyber%/g, '');
                }else{
                    citem = citem.replace(/%visibility_cucanocombo%/g, 'hidden');
                }
            }else{
                citem = citem.replace(/%CucardaUrlImageExterna%/g, "");
                citem = citem.replace(/%visibility_cucacombo%/g, 'hidden');
                if(item.Image_CucardaUrlImage){
                    citem = citem.replace(/%CucardaUrlImage%/g, item.Image_CucardaUrlImage);
                    citem = citem.replace(/%visibility_cucanocombo%/g, 'visible');

                    if (item.Image_CucardaUrlImage.indexOf('Artboard_7') > -1) {
                        citem = citem.replace(/%cucacyber%/g, 'flag_cyber');
                    }
                    citem = citem.replace(/%cucacyber%/g, '');
                }else{
                    citem = citem.replace(/%CucardaUrlImage%/g, "");
                    citem = citem.replace(/%visibility_cucanocombo%/g, 'hidden');
                }
            }



            templateBigBannerCategoria = templateBigBannerCategoria + citem;
        });

        templateBigBannerCategoria = templateBigBannerCategoria + '</div>'+ BraindwBuildImage(configs, 'right')+'</div>'+ BraindwBuildImage(configs, '', true)+'</div></div></section>';
        templateBigBannerCategoria = templateBigBannerCategoria + '</div>';
        templateBigBannerCategoria = templateBigBannerCategoria.replace(/%sectionEvent%/g, eventName);

        try {
            if (configs != undefined && configs != null) {
                templateBigBannerCategoria += BdwGondolaStyle(gondola, configs.sliderWidth, configs.sliderPadding, configs.sliderFloatSide, configs.margin,type);
            } else {
                templateBigBannerCategoria += BdwGondolaStyle(gondola, '100%', '', 'initial','',type);
            }
        } catch (e) {
            console.log(e);
        }

        return templateBigBannerCategoria;
    }

    return "";
}

function braindwStartCarousel(gondola, numberOfItems, marginRight) {
    numberOfItems = numberOfItems === undefined ? 5 : numberOfItems;
    marginRight = marginRight === undefined ? 10 : marginRight;
    var items = jQuery('.' + gondola+ ' .braindw_item').length;

    var itemsMinus = 0;

    jQuery('.' + gondola).owlCarousel({
        margin: marginRight,
        loop: items > 4,
        nav: true,
        dots: true,
        rewind: false,
        responsive: {
            0: {
                items: 2,
                nav: true,
            },
            480: {
                items: 2,
            },
            668: {
                items: numberOfItems - 2,
            },
            800:{
                items: numberOfItems - 1,
            },
            1200: {
                items: numberOfItems,

            }
        },
        onResized: function(event){
            var img = $('.' + gondola).closest('.braindw_columns').find('.bw_imagen_lateral_simple img');
            img.css('height',img.css('height',$('#' + gondola).find('.owl-stage-outer').height()));
        }
    });

    setTimeout(function(){
        try{
            $('.owl-loaded').trigger('refresh.owl.carousel');
        }
        catch(e){
            console.log(e);
        }
    },800);
}

function braindwStartHeader(gondola, numberOfItems, marginRight) {
    numberOfItems = numberOfItems === undefined ? 5 : numberOfItems;
    marginRight = marginRight === undefined ? 10 : marginRight;
    var items = jQuery('.' + gondola+ ' .braindw_item').length;

    var itemsMinus = 0;
    if ($('.bw_imagen_lateral_simple').length > 0) {
    itemsMinus = parseInt($('.bw_imagen_lateral_simple').data('minus'));
    }

    jQuery('.' + gondola).owlCarousel({
        margin: marginRight,
        loop: items > 2,
        nav: true,
        dots: false,
        rewind: false,
        autoplay: false,
        autoplayTimeout: 5300,
        autoplaySpeed: 1700,
        autoplayHoverPause: true,
        responsive: {
            0: {
                items: 1,
                dots: false,
                nav: true,
            },
            600: {
                items: 2
            }
        },
        onResized: function(event){
            var img = $('.' + gondola).closest('.braindw_columns').find('.bw_imagen_lateral_simple img');
            img.css('height',img.css('height',$('#' + gondola).find('.owl-stage-outer').height()));
        },
        onInitialized:function(event){
        }
    });

    setTimeout(function(){
        try{
            $('.owl-loaded').trigger('refresh.owl.carousel');
        }
        catch(e){
            console.log(e);
        }
    },800);
}

function BdwBuildConfigObject(idTemplateConfig, paramsConfig) {
    var bdwTemplateConfig = {};
    var differentGroups = [];
    for (var i = 0; i < paramsConfig.length; i++) {
        var keysConfig = Object.entries(paramsConfig[i]);
        for (var j = 0; j < keysConfig.length; j++) {
            if (keysConfig[j][0] == "group" && !differentGroups.includes(keysConfig[j][1])) {
                if (keysConfig[j][1] != "undefined") {
                    differentGroups.push(keysConfig[j][1]);
                }
            }

        }
    }

    var valuesImageGeneral = {};
    switch (idTemplateConfig) {
        case '0001': {
            bdwTemplateConfig = {
                sliderWidth: '80.5%',
                sliderFloatSide: 'right',
                sliderPadding: '',
                carouselItemsNum: 4,
                carouselItemsMargin: 10,
                margin: '',
                minus: 1
            };
            valuesImageGeneral = {
                width: '23%',
                marginSide: ['margin-right: 0'],
                floatImage: ['left']
            };
            break;
        }
        case '0002': {
            bdwTemplateConfig = {
                sliderWidth: '80.5%',
                sliderFloatSide: 'left',
                sliderPadding: 'margin-right:15px',
                carouselItemsNum: 4,
                carouselItemsMargin: 10,
                margin: '',
                minus: 1
            };
            valuesImageGeneral = {
                width: '23%',
                marginSide: ['margin: 0 0 0 10px'],
                floatImage: ['right']
            };
            break;
        }
        case '0003': {
            bdwTemplateConfig = {
                sliderWidth: '60%',
                navigationContainerWidth: '49.5%',
                sliderFloatSide: 'left',
                sliderPadding: 'margin-right:15px',
                navArrowMargin: 'margin-right: -1%',
                carouselItemsNum: 3,
                carouselItemsMargin: 10,
                margin: '',
                minus: 2
            };
            valuesImageGeneral = {
                width: '23%',
                marginSide: ['margin: 0 0 0 10px'],
                floatImage: ['left', 'right']
            };
            break;
        }
        case '0004': {
            bdwTemplateConfig = {
                sliderWidth: '60%',
                sliderFloatSide: 'left',
                sliderPadding: '',
                carouselItemsNum: 3,
                carouselItemsMargin: 10,
                margin: '',
                minus: 2
            };
            valuesImageGeneral = {
                width: '35%',
                marginSide: ['margin: 0 0 0 10px'],
                floatImage: ['left']
            };
            break;
        }
        case '0005': {
            bdwTemplateConfig = {
                sliderWidth: '60%',
                sliderFloatSide: 'left',
                sliderPadding: 'margin-right:15px',
                carouselItemsNum: 3,
                carouselItemsMargin: 10,
                margin: '',
                minus: 2
            };
            valuesImageGeneral = {
                width: '35%',
                marginSide: ['margin: 0 0 0 10px'],
                floatImage: ['right']
            };
            break;
        }
    }

    var imagesObjects = [];
    for(var k=0; k<differentGroups.length; k++){
        var group = differentGroups[k];
        var linkData = paramsConfig.filter(function(value){
            return value.group == group && value.type == "link";
        });
        var imgUrlData = paramsConfig.filter(function(value){
            return value.group == group && value.type == "img";
        });
        imagesObjects.push({
            url: imgUrlData[0].value,
            linkImg: linkData[0].value,
            width: valuesImageGeneral.width,
        });
    }

    bdwTemplateConfig.floatImage = valuesImageGeneral.floatImage;
    bdwTemplateConfig.imagesObjects = imagesObjects;

    bdwTemplateConfig.titleLeft = paramsConfig.filter(function(value) {
        return value.key == "title1";
    });

    bdwTemplateConfig.titleLeft = bdwTemplateConfig.titleLeft != null ? bdwTemplateConfig.titleLeft[0] : null;

    bdwTemplateConfig.titleRight = paramsConfig.filter(function(value) {
        return value.key == "title2";
    });

    bdwTemplateConfig.titleRight = bdwTemplateConfig.titleRight != null ? bdwTemplateConfig.titleRight[0] : null;

    return bdwTemplateConfig;
}
 var braindwgondola7_resultJson = { 'id':'0005','title':'', 'settings':[{'key':'title1','type':'text','value':'Combos en Caja','group':'undefined'},{'key':'image','type':'img','value':'https://storage.cdn.braindw.com/clubdebeneficios_produccion/script/files/2022/03/21/CdbBrainwdcomboencajas.jpg','group':'1'},{'key':'url','type':'link','value':'https://clubdebeneficios.com/combos/combos-por-caja.html','group':'1'},]};
 /*Summa*/
 var bdwJsonResult=[
  {
    "Attr": null,
    "IdArticulo": "Jabon-dos-test",
    "Sku": "2220",
    "UrlImagen": "https://unilever-club-de-beneficios2.localhost/static/version1652702271/frontend/ClubDeBeneficios/default/es_AR/Magento_Catalog/images/product/placeholder/small_image.jpg",
    "Descripcion": "Jabon dos test",
    "Precio": "$6.000",
    "PrecioM2": null,
    "PrecioKgLtr": "",
    "PrecioInternet": "$6.000",
    "PrecioAnterior": "$4.004,00",
    "PrecioAnteriorTitulo": null,
    "Stock": "10000",
    "Marca": "",
    "Categoria": null,
    "SuperOferta": null,
    "Articulo_Oferta": "¡OFERTA!",
    "CucardaOferta": "40% OFF",
    "Image_CucardaUrlImage": "",
    "Image_CucardaUrlImageExterna": "",
    "Descuento_Tipo": null,
    "Descuento_Subtipo": null,
    "Descuento_Prioridad": 0,
    "Descuento_Imagen": null,
    "Descuento_Descripcion": null,
    "Descuento_Descripcion_Email": null,
    "URLRenderBanner": null,
    "Link": "https://unilever-club-de-beneficios2.localhost/jabon-dos-test.html",
    "EMail_Price1_Title": null,
    "EMail_Price1_Value": null,
    "EMail_Price2_Title": null,
    "EMail_Price2_Value": null,
    "EMail_Price3_Title": null,
    "EMail_Price3_Value": null,
    "EMail_Color1": null,
    "Cuota_Numero": null,
    "Cuota_Monto": null,
    "Email_Cuota_Title": null,
    "HtmlKey": null,
    "IdCategoria": "",
    "Views": "1",
    "Added": "1018",
    "addToCart": "https://unilever-club-de-beneficios2.localhost/checkout/cart/add/uenc/aHR0cHM6Ly91bmlsZXZlci1jbHViLWRlLWJlbmVmaWNpb3MyLmxvY2FsaG9zdC8%2C/product/2220/",
    "updateToCart": "https://unilever-club-de-beneficios2.localhost/checkout/sidebar/updateItemQty/",
    "removeToCart": "https://unilever-club-de-beneficios2.localhost/checkout/sidebar/removeItem/",
    "PrecioKgLtrUnidad": "un",
    "EMail_PriceCustom_Value": "",
    "EMail_PriceCustom_Title": null,
    "UnidadPrecio": null,
    "PromocionesData": null,
    "IsNew": null,
    "FechaFinLanzamiento": null,
    "Model": null,
    "SaleNumber": null,
    "CuotaDescripcion": null,
    "CuotaTarjeta": null,
    "CuotaFinanciacion": null,
    "IdArticuloCarro": null,
    "Color": null,
    "Talle": null,
    "Sucursal": null,
    "SucursalCodigo": null,
    "DateUpdate": null,
    "Items": null,
    "Promociones": null
  }
];//BEGIN_CONFIG
var configJson = [{
    "id": "0001",
    "title": "Gondola de 1 Imagen a la Izquierda y 4 Productos",
    "previewImageUrl": "",
    "settings": [{
            "key": "title1",
            "title": "Titulo",
            "value": "",
            "type": "text"
        },
        {
            "key": "image",
            "title": "Subir Imagen",
            "value": "",
            "type": "img",
            "group": "1",
            "width": "235",
            "height": "405"
        },
        {
            "key": "url",
            "title": "Link Image",
            "value": "",
            "type": "link",
            "group": "1"
        }
    ]
    },
    {
        "id": "0002",
        "title": "Gondola de 1 Imagen a la Derecha y 4 Productos",
        "previewImageUrl": "",
        "settings": [{
                "key": "title1",
                "title": "Titulo",
                "value": "",
                "type": "text"
            },
            {
                "key": "image",
                "title": "Subir Imagen",
                "value": "",
                "type": "img",
                "group": "1",
                "width": "235",
                "height": "405"
            },
            {
                "key": "url",
                "title": "Link Image",
                "value": "",
                "type": "link",
                "group": "1"
            }
        ]
    },
    {
        "id": "0003",
        "title": "Gondola de 2 Imagenes a Ambos Extremos",
        "previewImageUrl": "",
        "settings": [{
                "key": "title1",
                "title": "Titulo",
                "value": "",
                "type": "text"
            },
            {
                "key": "image",
                "title": "Subir Imagen Derecha",
                "value": "",
                "type": "img",
                "group": "1",
                "width": "235",
                "height": "405"
            },
            {
                "key": "url1",
                "title": "Link Derecha",
                "value": "",
                "type": "link",
                "group": "1"
            },
            {
                "key": "image",
                "title": "Subir Imagen Izquierda",
                "value": "",
                "type": "img",
                "group": "2",
                "width": "235",
                "height": "405"
            },
            {
                "key": "url2",
                "title": "Link Izquierda",
                "value": "",
                "type": "link",
                "group": "2"
            }
        ]
    },
    {
        "id": "0004",
        "title": "Gondola de 1 Imagen Grande (3 lugares) a la Izquierda",
        "previewImageUrl": "",
        "settings": [{
                "key": "title1",
                "title": "Titulo",
                "value": "",
                "type": "text"
            },
            {
                "key": "image",
                "title": "Subir Imagen",
                "value": "",
                "type": "img",
                "group": "1",
                "width": "470",
                "height": "405"
            },
            {
                "key": "url",
                "title": "Link Image",
                "value": "",
                "type": "link",
                "group": "1"
            }
        ]
    },
    {
        "id": "0005",
        "title": "Gondola de 1 Imagen Grande (3 lugares) a la Derecha",
        "previewImageUrl": "",
        "settings": [{
                "key": "title1",
                "title": "Titulo",
                "value": "",
                "type": "text"
            },
            {
                "key": "image",
                "title": "Subir Imagen",
                "value": "",
                "type": "img",
                "group": "1",
                "width": "470",
                "height": "405"
            },
            {
                "key": "url",
                "title": "Link Image",
                "value": "",
                "type": "link",
                "group": "1"
            }
        ]
    },
]
//END_CONFIG
try{
        window['braindwgonda7'] = bdwJsonResult;

        var _bdwSettings = null;
        if (window['braindwgonda7'] !== undefined && window['braindwgonda7'].length > 0) {
            var bdwitems = 5,
                sliderwidth = '100%',
                imagewidth = '100%';
                if (typeof window['braindwgondola7' + "_resultJson"] != 'undefined') {console.log("summa",bdwJsonResult);
                    _bdwSettings = BdwBuildConfigObject(window['braindwgondola7' + "_resultJson"].id, window['braindwgondola7' + "_resultJson"].settings);
                    bdwitems = _bdwSettings.carouselItemsNum;
                    sliderwidth = _bdwSettings.sliderWidth;
                    imagewidth = _bdwSettings.imagesObjects[0].width;
                }
            if (document.contains(document.querySelector('#' + 'braindwgondola7'))) {
                document.querySelector('#' + 'braindwgondola7').remove();
            }

            var _braindwtemplate = BraindwRenderBanner(window['braindwgonda7'], 'braindwgondola7', 'Combos en Caja ', 'BDW-Home-Carrusel-7', 'braindwgonda7', _bdwSettings, '' ,'<%TEMPLATE_TYPE%>');
            if (_braindwtemplate !== '' && _braindwtemplate != null && window.jQuery) {
                if ('') {
                    jQuery('').remove();
                }
                document.querySelector(".braindw-internal-container").insertAdjacentHTML('beforeend', _braindwtemplate);
                if ('<%TEMPLATE_TYPE%>' === 'header') {
                    braindwStartHeader('braindwgondola7', 1, 0);
                } else {
                    braindwStartCarousel('braindwgondola7', bdwitems, 0);
                }

                var heightCarousel = '';
                if(bdwMobile.any()){
                    heightCarousel = "400";
                }
                else{
                        heightCarousel = "530";
                }
                if (typeof window['braindwgondola7' + "_resultJson"] != 'undefined') {
                    window.parent.postMessage("FullLoadedCarouselWithConfig|" + heightCarousel + "|#BDW-Home-Carrusel-7", '*');

                } else {
                    window.parent.postMessage("FullLoadedCarousel|" + heightCarousel + "|#BDW-Home-Carrusel-7", '*');
                }
                window['braindwgonda7_DATA_EVENT'] = window['braindwgonda7'].map((item,pos)=> ({id:item.IdArticulo,price:item.Precio.replace('.','').replace(',','.'),name:item.Descripcion,brand:item.Marca,category:item.Categoria ? item.Categoria.split('/')[item.Categoria.split('/').length - 2] : "",variant:undefined,position:pos}))
                window.parent.postMessage("PushEventCarousel|BDW-Home-Carrusel-7_braindwgonda7_"+ JSON.stringify(window['braindwgonda7_DATA_EVENT']), '*');
                window.parent.postMessage("BraindwRemoveElements|", '*');

            }
        }
        window.parent.postMessage("FinishRenderBdw", '*');
    }catch (e) {
        console.log(e);
    }



</script>




<script type="text/javascript">

//inicial
function geBdwtMeta(metaProperty) {
    try{
    const metas = document.getElementsByTagName('meta');

    for (let i = metas.length-1; i >0; i--) {
      if (metas[i].getAttribute('property') === metaProperty) {
      return metas[i].getAttribute('content');
      }
    }
  }catch{}
    return '';
    }

    // Cambio de endpoint desplegable
    var bdwLastSearchTerm = "";
    var tempBraidwVar;
    let bdwController;
    var oldXMLHttpRequest = XMLHttpRequest;
    (function () {
    // define constructor for my proxy object
    XMLHttpRequest = function () {
      var actual = new oldXMLHttpRequest();
      var self = this;
      this.onreadystatechange = null;
      // this is the actual handler on the real XMLHttpRequest object
      actual.onreadystatechange = async function () {
      if (this.readyState == 4) {
        self.responseText = actual.responseText;
        if (
        actual.responseURL != null &&
        actual.responseURL.indexOf("/search/ajax/suggest") != -1 &&
        actual.responseURL.indexOf("&__") == -1
        ) {
        const term = actual.responseURL.split("&")[0].split("q=")[1];
        var bdwIsLoged = true;
        try {
          document.querySelector(".amsearch-leftside").remove();
          document.querySelector("#amasty-shopby-product-list").style.width =
          "100%";
          document.querySelector(
          ".amsearch-results"
          ).childNodes[1].textContent = "";
          document
          .querySelector("#amasty-shopby-product-list")
          .childNodes[
            document.querySelector("#amasty-shopby-product-list").childNodes
            .length - 1
          ].remove();
        } catch (e) {}
        try {
          bdwController.abort();
        } catch (e) {}
        bdwController = new AbortController();
        setTimeout(() => {
          try {
          bdwController.abort();
          } catch (e) {}
        }, 4000);
        if (jQuery(".loggedin_title").length == 0) bdwIsLoged = false;
        bdwLastSearchTerm = term;
        //chinese = hasChinese(decodeURI(term));


        const isLogged =
        document.querySelectorAll(".logged-in").length == 0
          ? false
          : true;
        const url = !isLogged
        ? "https://u.braindw.com/els/clubdebeneficios?ft=" +
          term +
          "&qt=5&sc=1&refreshmetadata=false&apisearch=true"
        : "https://u.braindw.com/els/clubdebeneficios?ft=" +
          term +
          "&qt=5&sc=1&refreshmetadata=true&apisearch=true";
        const transformProduct = (item) => {
        let returnObject;
        if (isLogged) {
          if (item.PrecioAnterior == "" || item.PrecioAnterior === null) {
          returnObject = {
            type: "product",
            title: item.Descripcion,
            image: item.UrlImagen,
            url: item.Link,
            price: `<div class=\"price-box price-final_price\" data-role=\"priceBox\" data-product-id=\"${
            item.Sku
            }\" data-price-box=\"product-id-${
            item.Sku
            }\">\n\n\n    \n\n<span class=\"price-container price-final_price&#x20;tax&#x20;weee\"\n        >\n        <span  id=\"product-price-${
            item.Sku
            }\"                data-price-amount=\"${item.PrecioInternet.replace(
            "$",
            ""
            )}\"\n        data-price-type=\"finalPrice\"\n        class=\"price-wrapper \"\n    ><span class=\"price\">${
            item.PrecioInternet
            }</span></span>\n        </span>\n\n</div>`,
          };
          } else {
          returnObject = {
            type: "product",
            title: item.Descripcion,
            image: item.UrlImagen,
            url: item.Link,
            price: `<div class=\"price-box price-final_price\" data-role=\"priceBox\" data-product-id=\"${
            item.Sku
            }\" data-price-box=\"product-id-${
            item.Sku
            }\">\n\n\n    <span class=\"old-price\">\n        \n\n<span class=\"price-container price-final_price&#x20;tax&#x20;weee\"\n        >\n            <span class=\"price-label\">Precio habitual</span>\n        <span  id=\"old-price-${
            item.Sku
            }\"                data-price-amount=\"${item.PrecioAnterior.replace(
            "$",
            ""
            )}\"\n        data-price-type=\"oldPrice\"\n        class=\"price-wrapper \"\n    ><span class=\"price\">${
            item.PrecioAnterior
            }</span></span>\n        </span>\n    </span>\n    <div class=\"percentage-discount\">\n        <span class=\"special-price\">\n            \n\n<span class=\"price-container price-final_price&#x20;tax&#x20;weee\"\n        >\n            <span class=\"price-label\">Precio especial</span>\n        <span  id=\"product-price-${
            item.Sku
            }\"                data-price-amount=\"${item.PrecioInternet.replace(
            "$",
            ""
            )}\"\n        data-price-type=\"finalPrice\"\n        class=\"price-wrapper \"\n    ><span class=\"price\">${
            item.PrecioInternet
            }</span></span>\n        </span>\n        </span>\n        \n            <span class=\"special-price-discount\"></span>\n        </div>\n\n</div>`,
          };
          }
        } else {
          returnObject = {
          type: "product",
          title: item.title,
          image: item.imageUrl,
          url: item.link,
          price: "",
          };
        }
        return returnObject;
        };
        const transformBrand = (item) => {
        let returnObject;
        let brand = isLogged
          ? item.Link.split("com/")[1].split("-")[0]
          : item.link.split("com/")[1].split("-")[0];
        let brandCapitalized =
          brand.charAt(0).toUpperCase() + brand.slice(1);
        returnObject = {
          attribute_code: "brand",
          attribute_label: "Marca",
          type: "product_attribute",
          count: 62,
          title: brandCapitalized,
          url:
          "https://clubdebeneficios.com/catalogsearch/result/?brand=" +
          brandCapitalized +
          "&q=" +
          brandCapitalized,
        };
        return returnObject;
        };
        const transformCategory = (item) => {
        let responseObject;
        let category = isLogged
          ? item.Categoria.split("/")
            .pop()
            .replace(/-/g, " ")
            .toLowerCase()
          : item.categories
            .split("/")
            .pop()
            .replace(/-/g, " ")
            .toLowerCase();
        let categoryCapitalized =
          category.charAt(0).toUpperCase() + category.slice(1);
        responseObject = {
          type: "category",
          title: categoryCapitalized,
          url: "https://clubdebeneficios.com" + item.Categoria + ".html",
          breadcrumb: [],
        };
        return responseObject;
        };


        await fetch(
          url,
          { signal: bdwController.signal }
        )
          .then((res) => res.json())
          .then((response) => {


          //console.log(response);
          let items = "";
          let itemsArray = [];
          if (
            response &&
            //response.hits.hits.length > 0 &&
            bdwLastSearchTerm == term
          ) {
            let bdwTotalItems =0;
            if(isLogged) bdwTotalItems = response.length; else bdwTotalItems=response.hits.hits.length;


            let brands = [];
            let categories = [];
            let products = [];
            if (response !== undefined && bdwTotalItems <= 0) {
            self.responseText = actual.responseText;
            } else {
            var responseItems = response;
            if(!isLogged) responseItems = response.hits.hits;

            responseItems.forEach((item) => {

              JSON.stringify(item);
              if (products.length < 2) {
              products.push(
                transformProduct(isLogged ? item : item._source)
              );
              }
              let brand = isLogged
              ? item.Link.split("com/")[1].split("-")[0]
              : item._source.link.split("com/")[1].split("-")[0];
              let brandCapitalized =
              brand.charAt(0).toUpperCase() + brand.slice(1);
              if (
              brands.length < 3 &&
              brands.filter((i) => i.title == brandCapitalized).length == 0
              ) {
              brands.push(transformBrand(isLogged ? item : item._source));
              }
              let category = isLogged
              ? item.Categoria.split("/")
                .pop()
                .replace(/-/g, " ")
                .toLowerCase()
              : item._source.categories
                .split("/")
                .pop()
                .replace(/-/g, " ")
                .toLowerCase();
              let categoryCapitalized =
              category.charAt(0).toUpperCase() + category.slice(1);
              if (
              categories.length < 3 &&
              categories.filter((i) => i.title == categoryCapitalized)
                .length == 0
              ) {
              categories.push(
                transformCategory(isLogged ? item : item._source)
              );
              }
            });
            let finalResponse = [];
            finalResponse = finalResponse
              .concat(products)
              .concat(brands)
              .concat(categories);
            self.responseText = JSON.stringify(finalResponse);
            }


            // Agrego los eventos en click

            function BraindwPushEventIframe(cat, eti, sku) {
            try {
              if (sku != "") eti = eti + "[" + sku + "]";
              dataLayer.push({
              event: "ga-braindw",
              eventCategory: "ga-braindw",
              eventAction: cat,
              eventLabel: eti,
              });
            } catch (err) {
              console.log(err);
            }
            }
            setTimeout(function (f) {
            document
              .querySelectorAll(".autocomplete-list  .product")
              .forEach((node) => {
              node.addEventListener("click", (e) => {
                BraindwPushEventIframe(
                "desplegable-buscador",
                e.target.innerText.trim(),
                ""
                );
              });
              });
            }, 500);

          } else {
          }
          })
          .catch((e) => console.log(e.message));
        }
      }
      //self.responseText='';
      if (self.onreadystatechange) {
        return self.onreadystatechange();
      }
      };

      // add all proxy getters
      [
      "status",
      "statusText",
      "responseType",
      "response",
      "readyState",
      "responseXML",
      "upload",
      ].forEach(function (item) {
      Object.defineProperty(self, item, {
        get: function () {
        return actual[item];
        },
      });
      });

      // add all proxy getters/setters
      [
      "ontimeout, timeout",
      "withCredentials",
      "onload",
      "onerror",
      "onprogress",
      ].forEach(function (item) {
      Object.defineProperty(self, item, {
        get: function () {
        return actual[item];
        },
        set: function (val) {
        actual[item] = val;
        },
      });
      });

      // add all pure proxy pass-through methods
      [
      "addEventListener",
      "send",
      "open",
      "abort",
      "getAllResponseHeaders",
      "getResponseHeader",
      "overrideMimeType",
      "setRequestHeader",
      ].forEach(function (item) {
      Object.defineProperty(self, item, {
        value: function () {
        return actual[item].apply(actual, arguments);
        },
      });
      });
    };
    })();



  // fin buscador
  var BraindwDomReady = function (callback) {
    document.readyState === "interactive" || document.readyState === "complete"
      ? callback()
      : document.addEventListener("DOMContentLoaded", callback);
  };

  function Braindw_getProduct(data) {
    let e = null;
    if (data) {
      var s = {},
        t = braindw_getSessionDate();
      t && (s.sessionDate = t);

      var prod = data;
      e = {
        ProductCode: prod.codeproduct,
        Title: prod.title,
        PriceOnline: prod.price,
        Brand: prod.brand,
        Category: prod.categorycode,
        CategoryCode: prod.categorycode,
        UrlImage: prod.image,
        UrlProduct: document.URL,
        BranchOffice: BraindwGetSucCookie(),
      };
      s.product = e;
      braindw_sendPersistency(s);
    }
  }

  function Braindw_pushCategory() {
    try {
      var categorycode = location.pathname
        .split("/")
        [location.pathname.split("/").length - 1].replace(".html", "");
      var e = {
        Title: categorycode.replace("-", " "),
        CategoryCode: categorycode,
      };

      var s = {},
        t = braindw_getSessionDate();
      t && (s.sessionDate = t);
      s.category = e;
      braindw_sendPersistency(s);
    } catch (e) {}
  }

  function braindw_sendPersistency(e, emailGuest) {
    let n = {
      emailguest: emailGuest != undefined ? emailGuest : "",
      dataset: encodeURI(JSON.stringify(e)),
      page: "",
      url: window.location.href.split("?")[0],
      urlb:
        _URLBNDW +
        "/Script/braindw/clubdebeneficios_produccion_jknky?hs=Thu Dec 04 2019 20:49:26 GMT-0300 (hora estándar de Argentina)",
      BranchOffice: "",
    };
    fetch("https://p.braindw.com/Api/Data/Capture", {
      method: "POST",
      body: JSON.stringify(n),
      credentials: "include",
      headers: {
        Accept: "application/json",
        "Content-Type": "application/json",
      },
    })
      .then((resp) => resp.json())
      .then(function (data) {})
      .catch(function (ex) {
        console.log(ex);
      });
  }

  function BraindwGetCookie(key) {
    var BraindwCa = decodeURIComponent(document.cookie).split(";");
    for (var bnwi = 0; bnwi < BraindwCa.length; bnwi++) {
      if (BraindwCa[bnwi].indexOf(key) > -1) {
        return BraindwCa[bnwi].split("=")[1];
      }
    }
    return "";
  }

  function BraindwAddEvent(e, ev, callback) {
    var elements = document.querySelectorAll(e);
    for (var i = 0; i < elements.length; i++) {
      elements[i].addEventListener(ev, callback);
    }
  }

  function BraindwLoadScript(e, t, r) {
    var i = ($guadex = function (e) {
        i._.push(e);
      }),
      a = BraindwGetSucCookie(),
      o = (i.s = e.createElement(t)),
      n = e.getElementsByTagName(t)[0];
    (i.set = function (e) {
      i.set._.push(e);
    }),
      (i._ = []),
      (i.set._ = []),
      (o.async = !0),
      o.setAttribute("charset", "utf-8"),
      (o.src =
        _URLBNDW +
        "/tracking/track?HASH=clubdebeneficios_produccion_jknky&branchOffice=" +
        a +
        "&wordsfound=" +
        BraindwGetFoundWords() +
        "&buyer={CLIENT.BUYER}&name=&lastname=&gender=&country=&state=&city=&email=&u=" +
        escape(window.location) +
        "&hs=" +
        new Date()),
      (i.t = +new Date()),
      (o.type = "text/javascript"),
      n.parentNode.insertBefore(o, n);
  }

  function BraindwBuildCartItem(url, sku, quantity) {}

  function BraindwCaptureProduct(isCart, element) {
    if (!element) {
      element = document;
    }
    var data = {};
    data.title =
      element.querySelectorAll(".page-title span").length > 0
        ? element.querySelector(".page-title span").innerText.trim()
        : "";
    data.price =
      element.querySelectorAll(".price-final_price .price").length > 0
        ? element.querySelector(".price-final_price .price").innerText.trim()
        : "";
    data.oldPrice =
      element.querySelectorAll(".old-price .price").length > 0
        ? element.querySelector(".old-price .price").innerText.trim()
        : "";
    data.onlinePrice = data.price;

    //data.categoriescodes =
    //  element.querySelectorAll("#txtCategoriesPath")[0].value.split("/")[0] + ",";
    //data.categoriescodes += element.querySelectorAll(
    //  "#txtCategoriesPath"
    //)[0].value;
    data.categoriescodes = element.querySelectorAll("#txtCategoriesPath")[0].value;

    var bdwListOfObjects = []


    for(var iBdw=0; iBdw<data.categoriescodes.split(',').length;iBdw++)
    {

      var bdwCategoryValue = data.categoriescodes.split(',')[iBdw];
      if(bdwCategoryValue!='' && !bdwListOfObjects.includes(bdwCategoryValue)){
        bdwListOfObjects.push(bdwCategoryValue);
      }
      for(var iBdw2=0;iBdw2<bdwCategoryValue.split('/').length;iBdw2++ )
      {
        var bdwStrCategory = bdwCategoryValue.split('/')[iBdw2];
        if(bdwStrCategory!='' && !bdwListOfObjects.includes(bdwStrCategory)){
          bdwListOfObjects.push(bdwStrCategory);
        }
      }
    }

    data.categoriescodes = bdwListOfObjects.join(',') ;

    data.codeproduct =
      element.querySelectorAll(".product.attribute.sku .value").length > 0
        ? element
            .querySelector(".product.attribute.sku .value")
            .innerText.trim()
            .toLocaleLowerCase()
            .replace(/ /g, "-")
        : "";
    data.categorycode =
      data.categoriescodes.split(",").length > 0
        ? data.categoriescodes[data.categoriescodes.length - 1]
        : "";
    data.brand =
      element.querySelectorAll(".product-item-brand span").length > 0
        ? element.querySelector(".product-item-brand span").innerText.trim()
        : "";
    data.image =
      element.querySelectorAll(".magnifier-preview img").length > 0
        ? element.querySelector(".magnifier-preview img").getAttribute("src")
        : geBdwtMeta('og:image');
    if (data.price == data.oldPrice) data.oldPrice = "";

    var urlParameters =
      "og:title=" +
      encodeURIComponent(data.title) +
      "&og:image=" +
      encodeURIComponent(data.image) +
      "&og:url=" +
      document.URL.replace("#", "") +
      "&og:categoriescodes=" +
      data.categoriescodes +
      "&og:codeproduct=" +
      data.codeproduct +
      "&og:brand=" +
      data.brand +
      "&og:categorycode=" +
      data.categorycode +
      "&og:price=" +
      data.price +
      "&og:priceold=" +
      data.oldPrice +
      "&og:og:pricesale=" +
      data.onlinePrice +
      "&iscart=" +
      isCart;

    var _bndwOb2 = document.createElement("script");
    _bndwOb2.async = true;
    _bndwOb2.src = _URLBNDW + "/tracking/capture?HASH=clubdebeneficios_produccion_jknky&" + urlParameters;
    _bndwOb2.charset = "UTF-8";
    document.head.appendChild(_bndwOb2);

    if (!isCart) {
      Braindw_getProduct(data);
      BraindwGetCrossCustoms(data.categoriescodes);
      return;
    }
  }

  function BraindwCaptureCategory(category) {

    localStorage.setItem("bdw_last_category", category);
    var _bndwOb2 = document.createElement("script");
    _bndwOb2.async = true;
    _bndwOb2.src =
      _URLBNDW +
      "/tracking/capture?HASH=clubdebeneficios_produccion_jknky&iscategory=true&og:categorycode=" +
      category;
    _bndwOb2.charset = "UTF-8";
    document.head.appendChild(_bndwOb2);
  }

  function BraindwGetFoundWords() {
    var e = "",
      t = document.body.innerText.trim();
    t = t.replace(/(<([^>]+)>)/gi, " ").toLowerCase();
    var r = "{wordstofind}".split(",");
    for (i = 0; i < r.length; i++) -1 != t.indexOf(r[i]) && (e += r[i] + ",");
    return e;
  }

  var bdwMobile = {
    Android: function () {
      return navigator.userAgent.match(/Android/i);
    },
    BlackBerry: function () {
      return navigator.userAgent.match(/BlackBerry/i);
    },
    iOS: function () {
      return navigator.userAgent.match(/iPhone|iPad|iPod/i);
    },
    Opera: function () {
      return navigator.userAgent.match(/Opera Mini/i);
    },
    Windows: function () {
      return navigator.userAgent.match(/IEMobile/i);
    },
    any: function () {
      return (
        bdwMobile.Android() ||
        bdwMobile.BlackBerry() ||
        bdwMobile.iOS() ||
        bdwMobile.Opera() ||
        bdwMobile.Windows()
      );
    },
  };

  function bindEvent(element, eventName, eventHandler) {
    try {
      if (element.addEventListener)
        element.addEventListener(eventName, eventHandler, false);
      else if (element.attachEvent)
        element.attachEvent("on" + eventName, eventHandler);
    } catch (e) {}
  }

  function BraindwPushEventIframe(cat, eti, sku) {
    try {
      if (sku != "") eti = eti + "[" + sku + "]";
      dataLayer.push({
        event: "ga-braindw",
        eventCategory: "ga-braindw",
        eventAction: cat,
        eventLabel: eti,
      });
    } catch (err) {
      console.log(err);
    }
  }

  function AddToCartBraindwGond(url, sku, quantity) {
    try {
      let key = BraindwGetCookie("form_key");
      let formData = new FormData();
      formData.append("product", sku);
      formData.append("item", sku);
      formData.append("form_key", key);
      formData.append("qty", quantity);
      fetch(url, {
        credentials: "include",
        mode: "no-cors",
        method: "POST",
        body: formData,
      })
        .then((resp) => resp.text())
        .then(function (resp) {
          const eventCustomerData = new Event("reload_customer_data");
          document.dispatchEvent(eventCustomerData);
        })
        .catch(function (ex) {
          console.log(ex);
        });
    } catch (e) {}
  }
    //Extension Datalayer
//Formato del objeto con un tiempo de vida
function FormatWithTTL(productId, shelf, description, shelfname , sku, brand,price,position, ttl) {
  const now = new Date();
  var item = {
      product: {
          productId: productId,
          description: description,
          brand: brand,
          sku: sku,
          price:price,
          position: position
      },
      shelf: shelf,
      shelfname: shelfname,
      dateCreated: now,
      expiry: now.getTime() + ttl,
  }
  return item;
}

  //Chequea que no exista objeto repetido y si existe los elimina para pushear el visto por ultima vez
  function AlreadyExists(Items, i) {
    var filtered = Items.filter(function (item) {
        return item.product.productId !== i.product.productId;
    });
    return filtered;
  }

  //funcion Onclick
  function BdwDataLayer(key, productId, shelf, description, shelfname, sku, brand, position,price) {
    if (productId === null || shelf === null || key === null) return 0;
    const ttl = 7200000; //Equivale a un tiempo de vida de dos horas.
    var item = FormatWithTTL(productId, shelf, description, shelfname,sku, brand, price, position, ttl);
    var Items = JSON.parse(localStorage.getItem(key)) || [];
    Items = AlreadyExists(Items, item);
    Items.push(item);
    localStorage.setItem(key, JSON.stringify(Items));
  }
  //chequea si un producto esta en el localstorage
//chequea si un producto esta en el localstorage
function inLocalStorage(productId) {
  var key = "bdw-clicked-products";
  var Items = JSON.parse(localStorage.getItem(key));
  if (!Items) {
      return null;
  }
  var i = Items.length;
  while (i--) {
      if (Items[i].product.productId === productId.toString()) {
          return Items[i];
      }
  }
  return null;
}
  //elimina si se se paso el tiempo de vida
  function getWithExpiry() {
    const now = new Date();
    var key = "bdw-clicked-products";
    var Items = localStorage.getItem(key);
    if (!Items) {
        return null;
    }
    Items = JSON.parse(Items);
    for (var i = 0; i < Items.length; ++i) {
        if (now.getTime() > Items[i].expiry) {
            Items.shift();
        } else {
            break;
        }
    }
    Items = JSON.stringify(Items);
    localStorage.setItem(key, Items);
  }

function BraindwPushEventCarousel() {
  try {
    var impressions = [];
    for (var i = 0; i < arrayGond.length; i++) {
      let gondola = arrayGond[i];
      window[gondola + "_DATA_EVENT"].forEach(function (item) {
        item.list = gondola;
        item.dimensionBraindw = "Braindw";
        impressions.push(item);
      });
    }
    console.log("impressions" + impressions);

    dataLayer.push({
      event: "viewBraindw",
      ecommerce: {
        currencyCode: "ARS",
        impressions: impressions,
      },
    });
  } catch (err) {
    console.log(err);
  }
}


//Enhanced Ecommerce
function BraindwPushEventClickIframe(
    productId,
    cat,//Eventname
    eti,//Descripcion
    vitrina,//tittle
    sku,
    brand,
    position,
    price
) {
    try {
        dataLayer.push({
            event: "clickBraindw",
            ecommerce: {
                click: {
                    actionField: {
                        list: cat,
                    },
                    products: [{
                        name: eti,
                        //id: sku,
                        id:productId,
                        productId:productId,
                        brand: brand,
                        variant: undefined,
                        vitrina: vitrina,
                        position: position,
                        price : price,
                        "dimensionBraindw": "Braindw",
                    }, ],
                },
            },
        });
    } catch (err) {
        console.log(err);
    }
}

function BraindwPushEventBuyIframe(
    productId,
    cat,//Eventname
    eti,//Descripcion
    vitrina,//tittle
    sku,
    brand,
    position,
    price,
    quantity
) {
  //debugger;
    try {
        var priceFormat = price;
        dataLayer.push({
            event: "addToCartBraindw",
            ecommerce: {
                currencyCode: "ARS",
                add: {
                    actionField: {
                        list: cat,
                    },
                    products: [{
                        id: productId,
                        name: eti,
                        price: price,
                        quantity: quantity,
                        //id: sku,
                        //productId:productId,
                        brand: brand,
                        variant: undefined,
                        position:position,
                        vitrina:vitrina,
                        "dimensionBraindw": "Braindw",
                    }, ],
                },
            },
        });
    } catch (err) {
        console.log(err);
    }
}


  function receiveMessage(event) {
    try {
      if (!event.origin.includes("braindw")) return;

      if (event.data.includes("BraindwAddCartEvent")) {
        var dataToSend = event.data.split("|")[1].split(",");
        if (dataToSend.length > 1) {
          AddToCartBraindwGond(dataToSend[0], dataToSend[1], dataToSend[2]);
          BraindwCaptureRequest(dataToSend[3],1);
          BraindwPushEventIframeAddToCar(dataToSend[5], dataToSend[4], dataToSend[1]);
          Braindw_pushInfo();
        }
        return;
      }


      if (
        event.data.includes("FullLoadedCarouselWithConfig") ||
        event.data.includes("FullLoadedCarousel")
      ) {
        var dataReceived = event.data.split("|")[1];
        if (event.data === "FullLoadedCarouselWithConfig") {
          dataReceived = parseInt(dataReceived) + 50;
        }

        var elementReceived = document.querySelector(
          'div[id="' + event.data.split("|")[2] + '"]'
        );
        elementReceived.style.overflow = "hidden";
        elementReceived.style.position = "relative";
        elementReceived.style.width = "100%";

        if (elementReceived.querySelectorAll("iframe").length >= 0) {
          elementReceived.style.height = dataReceived + "px";
          console.log(event.data);
          console.log(elementReceived);
          elementReceived.style.display = "block";
          elementReceived.style.visibility = "visible";
          //clearTimeout(resetTimeEvent);
          resetTimeEvent = setTimeout(() => { BraindwPushEventCarousel() }, 3000);
        }

        return;
      }

      if (event.data.includes("BraindwRemoveElements")) {
        var sufixReceived = event.data.split("|")[1];
        var bdwRemoveClasses = sufixReceived.includes("TEMPLATE_REMOVECLASS")
          ? ""
          : sufixReceived;
        if (bdwRemoveClasses.length > 0) {
          var elementsRemoves = document.querySelectorAll(bdwRemoveClasses);
          elementsRemoves.forEach(function (item) {
            item.parentNode.removeChild(item);
          });
        }
        return;
      }
        if (event.data.includes("BraindwEventAnalyticsBuy")) {
            var dataToSend = event.data.split("|")[1].split("_");
            if (dataToSend[3] && dataToSend[4] && dataToSend[5] && dataToSend[6]) {
                BraindwPushEventBuyIframe(
                    dataToSend[2],//idArticulo
                    dataToSend[3],//BDW-Home-Carrusel-2
                    dataToSend[4],//item.Descripcion
                    dataToSend[5],//shelfname
                    dataToSend[6],//sku
                    dataToSend[7],// marca vacio
                    dataToSend[8],//posicion
                    dataToSend[9],//precio
                    dataToSend[10]);//cantidad
            }

        }
      if (event.data.includes("BraindwClickRedirectParent")) {
        var dataToSend = event.data.split("|")[1].split("_");
        if(event.data.includes('imagen-banner')){
          BraindwPushEventIframe(dataToSend[1],dataToSend[2],'');
        }else{
          BraindwPushEventIframe(dataToSend[3],dataToSend[4],dataToSend[6]);
          BdwDataLayer(dataToSend[1],//bdw-clicked-products
            dataToSend[2],//idArticulo
            dataToSend[3],//BDW-Home-Carrusel-2
            dataToSend[4],//item.Descripcion
            dataToSend[5],//shelfname
            dataToSend[6],//sku
            dataToSend[7],// marca
            dataToSend[8],//posicion
            dataToSend[9]);//precio
          BraindwPushEventClickIframe(
              dataToSend[2],//idArticulo
              dataToSend[3],//BDW-Home-Carrusel-2
              dataToSend[4],//item.Descripcion
              dataToSend[5],//shelfname
              dataToSend[6],//sku
              dataToSend[7],// marca vacio
              dataToSend[8],//posicion
              dataToSend[9]);//precio
        }


        window.location.href = dataToSend[0];
        return;
      }

      if (event.data.includes("PushEventCarousel")) {
        var dataToSend = event.data.split("|")[1].split("_");
        arrayGond.push(dataToSend[0]);
        arrayGond = Array.from(new Set(arrayGond));
        window[dataToSend[0] + "_DATA_EVENT"] = JSON.parse(dataToSend[2]);
      }

    } catch (e) {
      console.log(e);
    }
  }

  var _eventHandlers = {};
  function addListener(node, event, handler, capture) {
    if (!(node in _eventHandlers)) {
      _eventHandlers[node] = {};
    }
    if (!(event in _eventHandlers[node])) {
      _eventHandlers[node][event] = [];
    }
    _eventHandlers[node][event].push([handler, capture]);
    node.addEventListener(event, handler, capture);
  }

  //lo que debe hacer cuando compra un producto desde ficha producto
BraindwAddEvent("#product-addtocart-button", "click", function (e) {

  var ficha=document.querySelectorAll(".product-info-stock-sku");
  try {

      if (ficha.length==1) {
          var sku = "";
          var quantity = "";
          var checkedValue="";
          var brand="";

          var elemnt = document.querySelectorAll("#product-addtocart-button")[0];
          if (elemnt !== null) {
              quantity = 1;
          }
          brand=document.querySelector(".product-item-brand").innerText;
          if(brand==null || brand==undefined){brand=""};
          idcontainer = document.querySelector(".product-info-stock-sku");
          sku=idcontainer.innerText.split(" ")[1];
          if (sku !== "" && sku !== null && !isNaN(quantity)) {
              var item = inLocalStorage(sku);
              if (item !== null && item!= undefined) {
                  BraindwPushEventBuyIframe(
                    item.product.productId,
                    item.shelf,
                    item.product.description,
                    item.shelfname,
                    item.product.sku,
                    brand,
                    item.product.position,
                    item.product.price,
                    quantity
                  );

              }
          }
      }

  } catch (e) {}
});

  function removeAllListeners(node, event) {
    if (node in _eventHandlers) {
      var handlers = _eventHandlers[node];
      if (event in handlers) {
        var eventHandlers = handlers[event];
        for (var i = eventHandlers.length; i--; ) {
          var handler = eventHandlers[i];
          if (handler[0] === receiveMessage) {
            node.removeEventListener(event, handler[0], handler[1]);
          }
        }
      }
    }
  }

  function formatstringBnw(s) {
    var r = s.toLowerCase();
    r = r.replace(new RegExp(/\s/g), "");
    r = r.replace(new RegExp(/[àáâãäå]/g), "a");
    r = r.replace(new RegExp(/[èéêë]/g), "e");
    r = r.replace(new RegExp(/[ìíîï]/g), "i");
    r = r.replace(new RegExp(/ñ/g), "n");
    r = r.replace(new RegExp(/[òóôõö]/g), "o");
    r = r.replace(new RegExp(/[ùúûü]/g), "u");

    return r;
  }

  function BraindwGetSucCookie() {
    return "";
  }

  function braindw_getSessionDate() {
    let result = null;
    try {
      let SalesChannel = BraindwGetSucCookie();
      result = {
        SalesChannel: SalesChannel,
      };
    } catch (e) {
      console.log("braindw_getSessionDate error ", e);
    }
    return result;
  }

  function validateEmail(email) {
    var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return re.test(String(email).toLowerCase());
  }

  function braindwGetUrlParameter(name) {
    name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
    var regex = new RegExp("[\\?&]" + name + "=([^&#]*)");
    var results = regex.exec(location.search);
    return results === null
      ? ""
      : decodeURIComponent(results[1].replace(/\+/g, " "));
  }

  function bdwIsEmpty(obj) {
    for (var prop in obj) {
      if (obj.hasOwnProperty(prop)) {
        return false;
      }
    }

    return JSON.stringify(obj) === JSON.stringify({});
  }

  function Braindw_getCatOpened(cart) {
      let e = null;
      var items = [];
      if(!cart || cart.items.length === 0) return e;

      var data = cart;
      if(data != undefined){
          for (var i = 0; i < data.items.length; i++) {
              items.push({
                  ProductTitle: data.items[i].product_name,
                  ProductCode: data.items[i].product_sku,
                  ProductUrlImage: data.items[i].product_image.src,
                  ProductQuantity: data.items[i].qty,
                  ProductQuantityDetails: '',
                  ProductPrice: data.items[i].product_price_value,
                  PriceTotal: parseFloat(data.items[i].product_price_value) * data.items[i].qty,
                  Event: "Load"
              })
          }
      }

      e = {
          CartNumber: '',
          BranchOffice: BraindwGetSucCookie(),
          Items: items
      }

      return e;
  }

  function braindw_getSearch() {
      let result=null;
      try {
          var braindw_url=document.URL;
          if(braindw_url.toLowerCase().indexOf("/catalogsearch/result")===-1) return result;
          result={ searchterm: braindwGetUrlParameter("?q"), };
      } catch (e) { console.log(e); }

      return result;
  }

  function Braindw_getCartClosed() {
      return "";
  }

  function Braindw_pushInfo() {
      var bdwCustomer = JSON.parse(localStorage.getItem("mage-cache-storage"));
      if(braindw_getSearch === null){
        if (bdwIsEmpty(bdwCustomer) || bdwCustomer.cart.items.length === 0) {
            return;
        }
      }

      var emailGuest = localStorage.getItem("bdw_email");
      let e = {
          sessionDate: braindw_getSessionDate()
      };

      let _searchTerm = braindw_getSearch();
      if (_searchTerm) {
          e.search = _searchTerm;
      };

      let a = Braindw_getCatOpened(bdwCustomer.cart);
      a ? e.cartOpened = a : (a = Braindw_getCartClosed()) && (e.cartClosed = a);

      braindw_sendPersistency(e, emailGuest);
  }

  function BraindwvalidateEmail(email) {
      var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
      return re.test(String(email).toLowerCase());
  }

  function BraindwCookiePush(email) {
      if (BraindwvalidateEmail(email)) {
          var bdwEmailStorage = localStorage.getItem('bdw_email');
          if(bdwEmailStorage && bdwEmailStorage === email){
              return;
          }
          try {
              fetch(_URLBNDW + '/tracking/SetCookiesNdway?email=' + email + '&company=clubdebeneficios_produccion', {
                      credentials: "include",
                      mode: 'no-cors',
                      method: 'POST',
                  })
                  .then(function(resp) {
                      return resp.text();
                  })
                  .then(function(data) {
                      localStorage.setItem('bdw_email', email);
                      return false;
                  })
                  .catch(function(ex) {
                      console.log(ex);
                  });
          } catch (e) {}
      }
  }

  function BraindwCaptureRequest(url, iscart){
      fetch(url)
      .then((resp) => resp.text())
      .then(function (data) {
        var elt = document.createElement("body");
        elt.innerHTML = data;
        BraindwCaptureProduct(iscart, elt);
      })
      .catch(function (ex) {
        console.log(ex);
      });
  }

  function BdwInterceptorRequest(url, method, callback) {
    var __XHROpenFn = window.XMLHttpRequest.prototype.open;
    window.XMLHttpRequest.prototype.open = function (
      method,
      url,
      async,
      user,
      password
    ) {
      var event = new CustomEvent("request.open", {
        detail: {
          xhr: this,
          request: this,
          method: method,
          url: url,
          async: async,
        },
      });
      window.dispatchEvent(event);
      return __XHROpenFn.apply(this, arguments);
    };

    window.addEventListener("request.open", handleXHR);
    function handleXHR(ev) {
      if (
        ev.detail.method.toLowerCase() == method &&
        ev.detail.url.indexOf(url) > -1
      ) {
        ev.detail.xhr.onload = function () {
          if (ev.detail.xhr.readyState === 4 && ev.detail.xhr.status === 200) {
            callback(ev.detail.xhr.responseText);
          } else {
            console.error(xhr.statusText);
          }
        };
      }
    }
  }

  BdwInterceptorRequest("checkout/sidebar/removeItem/", "post", function (data) {
      setTimeout(function(e){
          Braindw_pushInfo();
      },2000);
  });

  var _URLBNDW = "";
  var isAttached = typeof isAttached !== "undefined" ? isAttached : false;
  var _HASHBNDW = "clubdebeneficios_produccion_jknky";
  var arrayGond = [];
  var resetTimeEvent = null;
  BraindwDomReady(function () {
    try {
      console.log("[Braindw] [begin]");
      _URLBNDW = window.location.protocol + "//s.braindw.com";
      BraindwLoadScript(document, "script", escape(window.location));
      window.onpopstate = function (e) {
        BraindwLoadScript(document, "script", escape(document.location));
      };

      if (!isAttached) {
        localStorage.setItem("currentPage", location.href);
        addListener(window, "message", receiveMessage, false);
        isAttached = true;
      }

      BraindwAddEvent(".tocart", "click", function (e) {
        if (document.querySelectorAll(".product.attribute.sku .value").length > 0) {
          return;
        }

        var urlProduct = e.currentTarget
          .closest(".product-item-info")
          .querySelector(".product-item-photo")
          .getAttribute("href");

        BraindwCaptureRequest(urlProduct, 1);
        Braindw_pushInfo();
      });

      Braindw_pushInfo();

      setTimeout(function(){
          if (document.URL.indexOf('/usuario/ingresar') > -1) {
              BraindwAddEvent(".action-login", "click", function (e) {
                  var email = document.querySelector('#customer-email').value;
                  if (!email) { return; }
                  BraindwCookiePush(email);
              });
          }
      }, 1500);

      getWithExpiry();

    } catch (e) {
      console.log("[Braindw] [error]");
    }
  });


  var BraindwDomReady = function (callback) {
    document.readyState === "interactive" || document.readyState === "complete"
      ? callback()
      : document.addEventListener("DOMContentLoaded", callback);
  };

  function Braindw_getProduct(data) {
    let e = null;
    if (data) {
      var s = {},
        t = braindw_getSessionDate();
      t && (s.sessionDate = t);

      var prod = data;
      e = {
        ProductCode: prod.codeproduct,
        Title: prod.title,
        PriceOnline: prod.price,
        Brand: prod.brand,
        Category: prod.categorycode,
        CategoryCode: prod.categorycode,
        UrlImage: prod.image,
        UrlProduct: document.URL,
        BranchOffice: BraindwGetSucCookie(),
      };
      s.product = e;
      braindw_sendPersistency(s);
    }
  }

  function Braindw_pushCategory() {
    try {
      var categorycode = location.pathname
        .split("/")
        [location.pathname.split("/").length - 1].replace(".html", "");
      var e = {
        Title: categorycode.replace("-", " "),
        CategoryCode: categorycode,
      };

      var s = {},
        t = braindw_getSessionDate();
      t && (s.sessionDate = t);
      s.category = e;
      braindw_sendPersistency(s);
    } catch (e) {}
  }

  function braindw_sendPersistency(e, emailGuest) {
    let n = {
      emailguest: emailGuest != undefined ? emailGuest : "",
      dataset: encodeURI(JSON.stringify(e)),
      page: "",
      url: window.location.href.split("?")[0],
      urlb:
        _URLBNDW +
        "/Script/braindw/clubdebeneficios_produccion_jknky?hs=Thu Dec 04 2019 20:49:26 GMT-0300 (hora estándar de Argentina)",
      BranchOffice: "",
    };
    fetch("https://p.braindw.com/Api/Data/Capture", {
      method: "POST",
      body: JSON.stringify(n),
      credentials: "include",
      headers: {
        Accept: "application/json",
        "Content-Type": "application/json",
      },
    })
      .then((resp) => resp.json())
      .then(function (data) {})
      .catch(function (ex) {
        console.log(ex);
      });
  }

  function BraindwGetCookie(key) {
    var BraindwCa = decodeURIComponent(document.cookie).split(";");
    for (var bnwi = 0; bnwi < BraindwCa.length; bnwi++) {
      if (BraindwCa[bnwi].indexOf(key) > -1) {
        return BraindwCa[bnwi].split("=")[1];
      }
    }
    return "";
  }

  function BraindwAddEvent(e, ev, callback) {
    var elements = document.querySelectorAll(e);
    for (var i = 0; i < elements.length; i++) {
      elements[i].addEventListener(ev, callback);
    }
  }

  function BraindwLoadScript(e, t, r) {
    var i = ($guadex = function (e) {
        i._.push(e);
      }),
      a = BraindwGetSucCookie(),
      o = (i.s = e.createElement(t)),
      n = e.getElementsByTagName(t)[0];
    (i.set = function (e) {
      i.set._.push(e);
    }),
      (i._ = []),
      (i.set._ = []),
      (o.async = !0),
      o.setAttribute("charset", "utf-8"),
      (o.src =
        _URLBNDW +
        "/tracking/track?HASH=clubdebeneficios_produccion_jknky&branchOffice=" +
        a +
        "&wordsfound=" +
        BraindwGetFoundWords() +
        "&buyer={CLIENT.BUYER}&name=&lastname=&gender=&country=&state=&city=&email=&u=" +
        escape(window.location) +
        "&hs=" +
        new Date()),
      (i.t = +new Date()),
      (o.type = "text/javascript"),
      n.parentNode.insertBefore(o, n);
  }

  function BraindwBuildCartItem(url, sku, quantity) {}

  function BraindwCaptureProduct(isCart, element) {
    if (!element) {
      element = document;
    }
    var data = {};
    data.title =
      element.querySelectorAll(".page-title span").length > 0
        ? element.querySelector(".page-title span").innerText.trim()
        : "";
    data.price =
      element.querySelectorAll(".price-final_price .price").length > 0
        ? element.querySelector(".price-final_price .price").innerText.trim()
        : "";
    data.oldPrice =
      element.querySelectorAll(".old-price .price").length > 0
        ? element.querySelector(".old-price .price").innerText.trim()
        : "";
    data.onlinePrice = data.price;
    data.categoriescodes = element.querySelectorAll("#txtCategoriesPath")[0].value;
    //data.categoriescodes =
    //  element.querySelectorAll("#txtCategoriesPath")[0].value.split("/")[0] + ",";
    //data.categoriescodes += element.querySelectorAll(
    //  "#txtCategoriesPath"
    //)[0].value;
    data.codeproduct =
      element.querySelectorAll(".product.attribute.sku .value").length > 0
        ? element
            .querySelector(".product.attribute.sku .value")
            .innerText.trim()
            .toLocaleLowerCase()
            .replace(/ /g, "-")
        : "";
    data.categorycode =
      data.categoriescodes.split(",").length > 0
        ? data.categoriescodes[data.categoriescodes.length - 1]
        : "";
    data.brand =
      element.querySelectorAll(".product-item-brand span").length > 0
        ? element.querySelector(".product-item-brand span").innerText.trim()
        : "";
    data.image =
      element.querySelectorAll(".magnifier-preview img").length > 0
        ? element.querySelector(".magnifier-preview img").getAttribute("src")
        : geBdwtMeta('og:image');
    if (data.price == data.oldPrice) data.oldPrice = "";



    var bdwListOfObjects = []


    for(var iBdw=0; iBdw<data.categoriescodes.split(',').length;iBdw++)
    {

      var bdwCategoryValue = data.categoriescodes.split(',')[iBdw];
      if(bdwCategoryValue!='' && !bdwListOfObjects.includes(bdwCategoryValue)){
        bdwListOfObjects.push(bdwCategoryValue);
      }
      for(var iBdw2=0;iBdw2<bdwCategoryValue.split('/').length;iBdw2++ )
      {
        var bdwStrCategory = bdwCategoryValue.split('/')[iBdw2];
        if(bdwStrCategory!='' && !bdwListOfObjects.includes(bdwStrCategory)){
          bdwListOfObjects.push(bdwStrCategory);
        }
      }
    }

    data.categoriescodes = bdwListOfObjects.join(',') ;



    var urlParameters =
      "og:title=" +
      encodeURIComponent(data.title) +
      "&og:image=" +
      encodeURIComponent(data.image) +
      "&og:url=" +
      document.URL.replace("#", "") +
      "&og:categoriescodes=" +
      data.categoriescodes +
      "&og:codeproduct=" +
      data.codeproduct +
      "&og:brand=" +
      data.brand +
      "&og:categorycode=" +
      data.categorycode +
      "&og:price=" +
      data.price +
      "&og:priceold=" +
      data.oldPrice +
      "&og:og:pricesale=" +
      data.onlinePrice +
      "&iscart=" +
      isCart;

    var _bndwOb2 = document.createElement("script");
    _bndwOb2.async = true;
    _bndwOb2.src = _URLBNDW + "/tracking/capture?HASH=clubdebeneficios_produccion_jknky&" + urlParameters;
    _bndwOb2.charset = "UTF-8";
    document.head.appendChild(_bndwOb2);

    if (!isCart) {
      Braindw_getProduct(data);
      BraindwGetCrossCustoms(data.categoriescodes);
      return;
    }
  }

  function BraindwCaptureCategory(category) {
    localStorage.setItem("bdw_last_category", category);
    var _bndwOb2 = document.createElement("script");
    _bndwOb2.async = true;
    _bndwOb2.src =
      _URLBNDW +
      "/tracking/capture?HASH=clubdebeneficios_produccion_jknky&iscategory=true&og:categorycode=" +
      category;
    _bndwOb2.charset = "UTF-8";
    document.head.appendChild(_bndwOb2);
  }

  //IMPLEMENTACION LOCALSTORAGE
  let localStorageNames = {
    ultimasCategoriasVisitadas: "bdwUltimasCategoriasVisitadas",
    productosVistos: "bdw_lasts_skus"
  };

  const addSkuLS = (sku, action) => {
    const storageName =
      action == "view"
        ? localStorageNames.productosVistos
        : localStorageNames.productosAgregados;
    let currentData = localStorage.getItem(storageName);
    if (currentData !== null) currentData = JSON.parse(currentData);
    if (currentData === null) currentData = [];
    if (currentData.includes(sku))
      currentData = currentData.filter((i) => i != sku);
    currentData.unshift(sku);
    currentData = currentData.slice(0, 10);
    localStorage.setItem(storageName, JSON.stringify(currentData));
  };

  function BraindwGetFoundWords() {
    var e = "",
      t = document.body.innerText.trim();
    t = t.replace(/(<([^>]+)>)/gi, " ").toLowerCase();
    var r = "{wordstofind}".split(",");
    for (i = 0; i < r.length; i++) -1 != t.indexOf(r[i]) && (e += r[i] + ",");
    return e;
  }

  var bdwMobile = {
    Android: function () {
      return navigator.userAgent.match(/Android/i);
    },
    BlackBerry: function () {
      return navigator.userAgent.match(/BlackBerry/i);
    },
    iOS: function () {
      return navigator.userAgent.match(/iPhone|iPad|iPod/i);
    },
    Opera: function () {
      return navigator.userAgent.match(/Opera Mini/i);
    },
    Windows: function () {
      return navigator.userAgent.match(/IEMobile/i);
    },
    any: function () {
      return (
        bdwMobile.Android() ||
        bdwMobile.BlackBerry() ||
        bdwMobile.iOS() ||
        bdwMobile.Opera() ||
        bdwMobile.Windows()
      );
    },
  };

  function bindEvent(element, eventName, eventHandler) {
    try {
      if (element.addEventListener)
        element.addEventListener(eventName, eventHandler, false);
      else if (element.attachEvent)
        element.attachEvent("on" + eventName, eventHandler);
    } catch (e) {}
  }

  function BraindwPushEventIframe(cat, eti, sku) {
    try {
      if (sku != "") eti = eti + "[" + sku + "]";
      dataLayer.push({
        event: "ga-braindw",
        eventCategory: "ga-braindw",
        eventAction: cat,
        eventLabel: eti,
      });
    } catch (err) {
      console.log(err);
    }
  }


  function BraindwPushEventIframeAddToCar(cat, eti, sku) {
    try {
      if (sku != "") eti = eti + "[" + sku + "]";
      dataLayer.push({
        event: "ga-braindw",
        eventCategory: "ga-braindw-addtocart",
        eventAction: cat,
        eventLabel: eti,
      });
    } catch (err) {
      console.log(err);
    }
  }

  function AddToCartBraindwGond(url, sku, quantity) {
    try {
      let key = BraindwGetCookie("form_key");
      let formData = new FormData();
      formData.append("product", sku);
      formData.append("item", sku);
      formData.append("form_key", key);
      formData.append("qty", quantity);
      fetch(url, {
        credentials: "include",
        mode: "no-cors",
        method: "POST",
        body: formData,
      })
        .then((resp) => resp.text())
        .then(function (resp) {
          const eventCustomerData = new Event("reload_customer_data");
          document.dispatchEvent(eventCustomerData);
        })
        .catch(function (ex) {
          console.log(ex);
        });
    } catch (e) {}
  }

  var _eventHandlers = {};
  function addListener(node, event, handler, capture) {
    if (!(node in _eventHandlers)) {
      _eventHandlers[node] = {};
    }
    if (!(event in _eventHandlers[node])) {
      _eventHandlers[node][event] = [];
    }
    _eventHandlers[node][event].push([handler, capture]);
    node.addEventListener(event, handler, capture);
  }

  function removeAllListeners(node, event) {
    if (node in _eventHandlers) {
      var handlers = _eventHandlers[node];
      if (event in handlers) {
        var eventHandlers = handlers[event];
        for (var i = eventHandlers.length; i--; ) {
          var handler = eventHandlers[i];
          if (handler[0] === receiveMessage) {
            node.removeEventListener(event, handler[0], handler[1]);
          }
        }
      }
    }
  }

  function formatstringBnw(s) {
    var r = s.toLowerCase();
    r = r.replace(new RegExp(/\s/g), "");
    r = r.replace(new RegExp(/[àáâãäå]/g), "a");
    r = r.replace(new RegExp(/[èéêë]/g), "e");
    r = r.replace(new RegExp(/[ìíîï]/g), "i");
    r = r.replace(new RegExp(/ñ/g), "n");
    r = r.replace(new RegExp(/[òóôõö]/g), "o");
    r = r.replace(new RegExp(/[ùúûü]/g), "u");

    return r;
  }

  function BraindwGetSucCookie() {
    return "";
  }

  function braindw_getSessionDate() {
    let result = null;
    try {
      let SalesChannel = BraindwGetSucCookie();
      result = {
        SalesChannel: SalesChannel,
      };
    } catch (e) {
      console.log("braindw_getSessionDate error ", e);
    }
    return result;
  }

  function validateEmail(email) {
    var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return re.test(String(email).toLowerCase());
  }

  function braindwGetUrlParameter(name) {
    name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
    var regex = new RegExp("[\\?&]" + name + "=([^&#]*)");
    var results = regex.exec(location.search);
    return results === null
      ? ""
      : decodeURIComponent(results[1].replace(/\+/g, " "));
  }

  function bdwIsEmpty(obj) {
    for (var prop in obj) {
      if (obj.hasOwnProperty(prop)) {
        return false;
      }
    }

    return JSON.stringify(obj) === JSON.stringify({});
  }

  function Braindw_getCatOpened(cart) {
      let e = null;
      var items = [];
      if(!cart || cart.items.length === 0) return e;

      var data = cart;
      if(data != undefined){
          for (var i = 0; i < data.items.length; i++) {
              items.push({
                  ProductTitle: data.items[i].product_name,
                  ProductCode: data.items[i].product_sku,
                  ProductUrlImage: data.items[i].product_image.src,
                  ProductQuantity: data.items[i].qty,
                  ProductQuantityDetails: '',
                  ProductPrice: data.items[i].product_price_value,
                  PriceTotal: parseFloat(data.items[i].product_price_value) * data.items[i].qty,
                  Event: "Load"
              })
          }
      }

      e = {
          CartNumber: '',
          BranchOffice: BraindwGetSucCookie(),
          Items: items
      }

      return e;
  }

  /*function Braindw_pushInfo() {
      var bdwCustomer = JSON.parse(localStorage.getItem("mage-cache-storage"));
      if (bdwIsEmpty(bdwCustomer) || bdwCustomer.cart.items.length === 0) {
          return;
      }

      var emailGuest = localStorage.getItem("bdw_email");
      let e = {
          sessionDate: braindw_getSessionDate()
      };

      let a = Braindw_getCatOpened(bdwCustomer.cart);
      a ? e.cartOpened = a : (a = Braindw_getCartClosed()) && (e.cartClosed = a);

      braindw_sendPersistency(e, emailGuest);
  }*/

  function BraindwvalidateEmail(email) {
      var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
      return re.test(String(email).toLowerCase());
  }

  function BraindwCookiePush(email) {
      if (BraindwvalidateEmail(email)) {
          var bdwEmailStorage = localStorage.getItem('bdw_email');
          if(bdwEmailStorage && bdwEmailStorage === email){
              return;
          }
          try {
              fetch(_URLBNDW + '/tracking/SetCookiesNdway?email=' + email + '&company=clubdebeneficios_produccion', {
                      credentials: "include",
                      mode: 'no-cors',
                      method: 'POST',
                  })
                  .then(function(resp) {
                      return resp.text();
                  })
                  .then(function(data) {
                      localStorage.setItem('bdw_email', email);
                      return false;
                  })
                  .catch(function(ex) {
                      console.log(ex);
                  });
          } catch (e) {}
      }
  }

  function BraindwCaptureRequest(url, iscart){
      fetch(url)
      .then((resp) => resp.text())
      .then(function (data) {
        var elt = document.createElement("body");
        elt.innerHTML = data;
        BraindwCaptureProduct(iscart, elt);
      })
      .catch(function (ex) {
        console.log(ex);
      });
  }

  function BdwInterceptorRequest(url, method, callback) {
    var __XHROpenFn = window.XMLHttpRequest.prototype.open;
    window.XMLHttpRequest.prototype.open = function (
      method,
      url,
      async,
      user,
      password
    ) {
      var event = new CustomEvent("request.open", {
        detail: {
          xhr: this,
          request: this,
          method: method,
          url: url,
          async: async,
        },
      });
      window.dispatchEvent(event);
      return __XHROpenFn.apply(this, arguments);
    };

    window.addEventListener("request.open", handleXHR);
    function handleXHR(ev) {
      if (
        ev.detail.method.toLowerCase() == method &&
        ev.detail.url.indexOf(url) > -1
      ) {
        ev.detail.xhr.onload = function () {
          if (ev.detail.xhr.readyState === 4 && ev.detail.xhr.status === 200) {
            callback(ev.detail.xhr.responseText);
          } else {
            console.error(xhr.statusText);
          }
        };
      }
    }
  }

  BdwInterceptorRequest("checkout/sidebar/removeItem/", "post", function (data) {
      setTimeout(function(e){
          Braindw_pushInfo();
      },2000);
  });


  function ultimosNavegados() {
    var _URLSTATIC = window.location.protocol + "//static-s.braindw.com";
    //verifica estar en Home
    let isHome = new RegExp(/.*?:\/\/(.*)clubdebeneficios.com($|\/|\/\?(.*))$/);
    if (isHome.test(document.URL)) {
      let lastCategory = localStorage.getItem("bdw_last_category");
      if (
        lastCategory !== null &&
        lastCategory !== undefined &&
        lastCategory !== ""
      ) {
        var _bndwOb2 = document.createElement("script");
        _bndwOb2.async = true;
        _bndwOb2.src =
        _URLSTATIC +
          "/tracking/track?HASH=clubdebeneficios_produccion_jknky&wordsfound=,&buyer={CLIENT.BUYER}&name=&lastname=&gender=&branchOffice=" +
          BraindwGetSucCookie() +
          "&country=&state=&city=&minify=1&email=&u=home.braindw.com/lastcategory/" +
          1 +
          "/" +
          lastCategory;
        _bndwOb2.charset = "UTF-8";
        document.head.appendChild(_bndwOb2);
      }

      let lastSkus = localStorage.getItem("bdw_lasts_skus");
      if (lastSkus !== null && lastSkus !== undefined && lastSkus !== "") {
        var _bndwOb3 = document.createElement("script");
        _bndwOb3.async = true;
        _bndwOb3.src =
        _URLSTATIC +
          "/tracking/track?HASH=clubdebeneficios_produccion_jknky&wordsfound=,&buyer={CLIENT.BUYER}&name=&lastname=&gender=&branchOffice=" +
          BraindwGetSucCookie() +
          "&country=&state=&city=&minify=1&email=&u=home.braindw.com/lastproducts/" +
          1 +
          "/" +
          lastSkus;
        _bndwOb3.charset = "UTF-8";
        document.head.appendChild(_bndwOb3);
      }
    }
  }

  var _URLBNDW = "";
  var _URLSTATIC = "";
  var isAttached = typeof isAttached !== "undefined" ? isAttached : false;
  var _HASHBNDW = "clubdebeneficios_produccion_jknky";
  BraindwDomReady(function () {
    try {
      console.log("[Braindw] [begin]");
      _URLSTATIC = window.location.protocol + "//static-s.braindw.com";
      _URLBNDW = window.location.protocol + "//s.braindw.com";
      BraindwLoadScript(document, "script", escape(window.location));
      window.onpopstate = function (e) {
        BraindwLoadScript(document, "script", escape(document.location));
      };

      if (!isAttached) {
        localStorage.setItem("currentPage", location.href);
        addListener(window, "message", receiveMessage, false);
        isAttached = true;
      }

      BraindwAddEvent(".tocart", "click", function (e) {
        if (document.querySelectorAll(".product.attribute.sku .value").length > 0) {
          return;
        }

        var urlProduct = e.currentTarget
          .closest(".product-item-info")
          .querySelector(".product-item-photo")
          .getAttribute("href");

        BraindwCaptureRequest(urlProduct, 1);
        Braindw_pushInfo();
      });

      Braindw_pushInfo();

      try{
        var skuProducto = undefined;
        if(document.querySelector('.product-info-stock-sku>div>div') !== null){
          skuProducto = document.querySelector('.product-info-stock-sku>div>div').innerText;
        }
      }catch(e){
          console.log(e);
      }
      if(skuProducto!= undefined){
        addSkuLS(skuProducto, "view");
      }

      setTimeout( function(){
        try{
          var codCat = undefined;
          if(document.getElementById('txtCategoriesPath') !== null){
            codCat = document.getElementById('txtCategoriesPath').value;
          }

          }catch(e){
              console.log(e);
          }
          if(codCat != undefined){
            codCat = codCat.split('/',[-1]);
            codCat = codCat[codCat.length -1];
            if(codCat.includes(',')){
                codCat = codCat.split(',',-1);
                codCat = codCat[0];
            }
            localStorage.setItem("bdw_last_category", codCat);
          }
      }, 1500);


    ultimosNavegados();

      setTimeout(function(){
          if (document.URL.indexOf('/usuario/ingresar') > -1) {
              BraindwAddEvent(".action-login", "click", function (e) {
                  var email = document.querySelector('#customer-email').value;
                  if (!email) { return; }
                  BraindwCookiePush(email);
              });
          }
      }, 1500);


    } catch (e) {
      console.log("[Braindw] [error]");
    }
  });

 try{ console.log('[abtest 0] [usertest ]'); } catch(e) {console.log('error load abtest log')}
</script>
</body>
</html>
